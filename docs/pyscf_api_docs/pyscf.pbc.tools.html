
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>pyscf.pbc.tools package &#8212; PySCF</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/pyscf.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="shortcut icon" href="../_static/favicon-32x32.png"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="pyscf.pbc.x2c package" href="pyscf.pbc.x2c.html" />
    <link rel="prev" title="pyscf.pbc.tdscf package" href="pyscf.pbc.tdscf.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=pyscf data-md-color-accent=pyscf>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#pyscf_api_docs/pyscf.pbc.tools" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="PySCF"
           class="md-header-nav__button md-logo">
          
              <img src="../_static/pyscf-logo-white.svg" height="26"
                   alt="PySCF logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">PySCF 2.0</span>
          <span class="md-header-nav__topic"> pyscf.pbc.tools package </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/pyscf/pyscf/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PySCF
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../"versions.json"",
        target_loc = "../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
            
            <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">Home</a></li>
            
            <li class="md-tabs__item"><a href="../install.html" class="md-tabs__link">Install</a></li>
            
            <li class="md-tabs__item"><a href="../quickstart.html" class="md-tabs__link">Quickstart</a></li>
            
            <li class="md-tabs__item"><a href="../user.html" class="md-tabs__link">User Guide</a></li>
            
            <li class="md-tabs__item"><a href="../develop.html" class="md-tabs__link">Developer Guide</a></li>
            
            <li class="md-tabs__item"><a href="modules.html" class="md-tabs__link">API</a></li>
            
            <li class="md-tabs__item"><a href="../about.html" class="md-tabs__link">About</a></li>
          <li class="md-tabs__item"><a href="pyscf.html" class="md-tabs__link">pyscf package</a></li>
          <li class="md-tabs__item"><a href="pyscf.pbc.html" class="md-tabs__link">pyscf.pbc package</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="PySCF" class="md-nav__button md-logo">
      
        <img src="../_static/pyscf-logo-white.svg" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="PySCF">PySCF 2.0</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/pyscf/pyscf/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PySCF
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="../install.html" class="md-nav__link">Install</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../quickstart.html" class="md-nav__link">Quickstart</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../user.html" class="md-nav__link">User Guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../develop.html" class="md-nav__link">Developer Guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pyscf.html" class="md-nav__link">API</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="pyscf.html#subpackages" class="md-nav__link">Subpackages</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pyscf.html#submodules" class="md-nav__link">Submodules</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pyscf.html#module-pyscf.post_scf" class="md-nav__link">pyscf.post_scf module</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pyscf.html#module-pyscf" class="md-nav__link">Module contents</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../about.html" class="md-nav__link">About</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#pyscf-api-docs-pyscf-pbc-tools--page-root" class="md-nav__link">pyscf.pbc.tools package</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#submodules" class="md-nav__link">Submodules</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.pbc.tools.k2gamma" class="md-nav__link">pyscf.pbc.tools.k2gamma module</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.pbc.tools.lattice" class="md-nav__link">pyscf.pbc.tools.lattice module</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.pbc.tools.make_test_cell" class="md-nav__link">pyscf.pbc.tools.make_test_cell module</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.pbc.tools.pbc" class="md-nav__link">pyscf.pbc.tools.pbc module</a>
        </li>
        <li class="md-nav__item"><a href="#pyscf-pbc-tools-pyscf-ase-module" class="md-nav__link">pyscf.pbc.tools.pyscf_ase module</a>
        </li>
        <li class="md-nav__item"><a href="#pyscf-pbc-tools-pywannier90-module" class="md-nav__link">pyscf.pbc.tools.pywannier90 module</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.pbc.tools.tril" class="md-nav__link">pyscf.pbc.tools.tril module</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.pbc.tools" class="md-nav__link">Module contents</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/pyscf_api_docs/pyscf.pbc.tools.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="pyscf-pbc-tools-package">
<h1 id="pyscf-api-docs-pyscf-pbc-tools--page-root">pyscf.pbc.tools package<a class="headerlink" href="#pyscf-api-docs-pyscf-pbc-tools--page-root" title="Permalink to this headline">¶</a></h1>
<section id="submodules">
<h2 id="submodules">Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</section>
<section id="module-pyscf.pbc.tools.k2gamma">
<span id="pyscf-pbc-tools-k2gamma-module"></span><h2 id="module-pyscf.pbc.tools.k2gamma">pyscf.pbc.tools.k2gamma module<a class="headerlink" href="#module-pyscf.pbc.tools.k2gamma" title="Permalink to this headline">¶</a></h2>
<p>Convert the k-sampled MO/integrals to corresponding Gamma-point supercell
MO/integrals.</p>
<p>Zhihao Cui &lt;<a class="reference external" href="mailto:zcui%40caltech.edu">zcui<span>@</span>caltech<span>.</span>edu</a>&gt;
Qiming Sun &lt;<a class="reference external" href="mailto:osirpt.sun%40gmail.com">osirpt<span>.</span>sun<span>@</span>gmail<span>.</span>com</a>&gt;</p>
<p>See also the original implementation at
<a class="reference external" href="https://github.com/zhcui/local-orbital-and-cdft/blob/master/k2gamma.py">https://github.com/zhcui/local-orbital-and-cdft/blob/master/k2gamma.py</a></p>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.k2gamma.double_translation_indices">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.k2gamma.</span></span><span class="sig-name descname"><span class="pre">double_translation_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kmesh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/k2gamma.html#double_translation_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.k2gamma.double_translation_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Indices to utilize the translation symmetry in the 2D matrix.</p>
<p>D[M,N] = D[N-M]</p>
<p>The return index maps the 2D subscripts to 1D subscripts.</p>
<p>D2 = D1[double_translation_indices()]</p>
<p>D1 holds all the symmetry unique elements in D2</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.k2gamma.get_phase">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.k2gamma.</span></span><span class="sig-name descname"><span class="pre">get_phase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kmesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/k2gamma.html#get_phase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.k2gamma.get_phase" title="Permalink to this definition">¶</a></dt>
<dd><p>The unitary transformation that transforms the supercell basis k-mesh
adapted basis.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.k2gamma.k2gamma">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.k2gamma.</span></span><span class="sig-name descname"><span class="pre">k2gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kmf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kmesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/k2gamma.html#k2gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.k2gamma.k2gamma" title="Permalink to this definition">¶</a></dt>
<dd><p>convert the k-sampled mean-field object to the corresponding supercell
gamma-point mean-field object.</p>
<dl class="simple">
<dt>math:</dt><dd><p>C_{nu ‘ n’} = C_{vecRmu, veck m} = frac{1}{sqrt{N_{UC}}}
e^{ii veckcdotvecR} C^{veck}_{mu  m}</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.k2gamma.kpts_to_kmesh">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.k2gamma.</span></span><span class="sig-name descname"><span class="pre">kpts_to_kmesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/k2gamma.html#kpts_to_kmesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.k2gamma.kpts_to_kmesh" title="Permalink to this definition">¶</a></dt>
<dd><p>Guess kmesh</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.k2gamma.mo_k2gamma">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.k2gamma.</span></span><span class="sig-name descname"><span class="pre">mo_k2gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kmesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/k2gamma.html#mo_k2gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.k2gamma.mo_k2gamma" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.k2gamma.to_supercell_ao_integrals">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.k2gamma.</span></span><span class="sig-name descname"><span class="pre">to_supercell_ao_integrals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao_ints</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/k2gamma.html#to_supercell_ao_integrals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.k2gamma.to_supercell_ao_integrals" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform from the unitcell k-point AO integrals to the supercell
gamma-point AO integrals.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.k2gamma.to_supercell_mo_integrals">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.k2gamma.</span></span><span class="sig-name descname"><span class="pre">to_supercell_mo_integrals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kmf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_ints</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/k2gamma.html#to_supercell_mo_integrals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.k2gamma.to_supercell_mo_integrals" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform from the unitcell k-point MO integrals to the supercell
gamma-point MO integrals.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.k2gamma.translation_map">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.k2gamma.</span></span><span class="sig-name descname"><span class="pre">translation_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nk</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/k2gamma.html#translation_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.k2gamma.translation_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate
[0    1 .. n  ]
[n    0 .. n-1]
[n-1  n .. n-2]
[…  …  …]
[1    2 .. 0  ]</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.k2gamma.translation_vectors_for_kmesh">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.k2gamma.</span></span><span class="sig-name descname"><span class="pre">translation_vectors_for_kmesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kmesh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/k2gamma.html#translation_vectors_for_kmesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.k2gamma.translation_vectors_for_kmesh" title="Permalink to this definition">¶</a></dt>
<dd><p>Translation vectors to construct super-cell of which the gamma point is
identical to the k-point mesh of primitive cell</p>
</dd></dl>
</section>
<section id="module-pyscf.pbc.tools.lattice">
<span id="pyscf-pbc-tools-lattice-module"></span><h2 id="module-pyscf.pbc.tools.lattice">pyscf.pbc.tools.lattice module<a class="headerlink" href="#module-pyscf.pbc.tools.lattice" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.lattice.get_ase_alkali_halide">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.lattice.</span></span><span class="sig-name descname"><span class="pre">get_ase_alkali_halide</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Li'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Cl'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/lattice.html#get_ase_alkali_halide"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.lattice.get_ase_alkali_halide" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.lattice.get_ase_atom">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.lattice.</span></span><span class="sig-name descname"><span class="pre">get_ase_atom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">formula</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/lattice.html#get_ase_atom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.lattice.get_ase_atom" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.lattice.get_ase_diamond_cubic">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.lattice.</span></span><span class="sig-name descname"><span class="pre">get_ase_diamond_cubic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'C'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/lattice.html#get_ase_diamond_cubic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.lattice.get_ase_diamond_cubic" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the ASE atoms for cubic (8-atom) diamond unit cell.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.lattice.get_ase_diamond_primitive">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.lattice.</span></span><span class="sig-name descname"><span class="pre">get_ase_diamond_primitive</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'C'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/lattice.html#get_ase_diamond_primitive"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.lattice.get_ase_diamond_primitive" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the ASE atoms for primitive (2-atom) diamond unit cell.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.lattice.get_ase_graphene">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.lattice.</span></span><span class="sig-name descname"><span class="pre">get_ase_graphene</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vacuum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/lattice.html#get_ase_graphene"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.lattice.get_ase_graphene" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the ASE atoms for primitive (2-atom) graphene unit cell.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.lattice.get_ase_graphene_xxx">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.lattice.</span></span><span class="sig-name descname"><span class="pre">get_ase_graphene_xxx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vacuum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/lattice.html#get_ase_graphene_xxx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.lattice.get_ase_graphene_xxx" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the ASE atoms for primitive (2-atom) graphene unit cell.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.lattice.get_ase_rocksalt">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.lattice.</span></span><span class="sig-name descname"><span class="pre">get_ase_rocksalt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Li'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Cl'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/lattice.html#get_ase_rocksalt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.lattice.get_ase_rocksalt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.lattice.get_ase_wurtzite">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.lattice.</span></span><span class="sig-name descname"><span class="pre">get_ase_wurtzite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Zn'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'O'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/lattice.html#get_ase_wurtzite"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.lattice.get_ase_wurtzite" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.lattice.get_ase_zincblende">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.lattice.</span></span><span class="sig-name descname"><span class="pre">get_ase_zincblende</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Ga'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'As'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/lattice.html#get_ase_zincblende"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.lattice.get_ase_zincblende" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.lattice.get_bandpath_fcc">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.lattice.</span></span><span class="sig-name descname"><span class="pre">get_bandpath_fcc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ase_atom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/lattice.html#get_bandpath_fcc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.lattice.get_bandpath_fcc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
</section>
<section id="module-pyscf.pbc.tools.make_test_cell">
<span id="pyscf-pbc-tools-make-test-cell-module"></span><h2 id="module-pyscf.pbc.tools.make_test_cell">pyscf.pbc.tools.make_test_cell module<a class="headerlink" href="#module-pyscf.pbc.tools.make_test_cell" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.make_test_cell.make_cell">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.make_test_cell.</span></span><span class="sig-name descname"><span class="pre">make_cell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/make_test_cell.html#make_cell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.make_test_cell.make_cell" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.make_test_cell.test_cell_cu_metallic">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.make_test_cell.</span></span><span class="sig-name descname"><span class="pre">test_cell_cu_metallic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[9,</span> <span class="pre">9,</span> <span class="pre">9]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/make_test_cell.html#test_cell_cu_metallic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.make_test_cell.test_cell_cu_metallic" title="Permalink to this definition">¶</a></dt>
<dd><p>Copper unit cell w/ special basis giving non-equal number of occupied orbitals per k-point</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.make_test_cell.test_cell_n0">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.make_test_cell.</span></span><span class="sig-name descname"><span class="pre">test_cell_n0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[9,</span> <span class="pre">9,</span> <span class="pre">9]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/make_test_cell.html#test_cell_n0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.make_test_cell.test_cell_n0" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.make_test_cell.test_cell_n1">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.make_test_cell.</span></span><span class="sig-name descname"><span class="pre">test_cell_n1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[9,</span> <span class="pre">9,</span> <span class="pre">9]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/make_test_cell.html#test_cell_n1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.make_test_cell.test_cell_n1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.make_test_cell.test_cell_n2">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.make_test_cell.</span></span><span class="sig-name descname"><span class="pre">test_cell_n2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[9,</span> <span class="pre">9,</span> <span class="pre">9]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/make_test_cell.html#test_cell_n2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.make_test_cell.test_cell_n2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.make_test_cell.test_cell_n3">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.make_test_cell.</span></span><span class="sig-name descname"><span class="pre">test_cell_n3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[9,</span> <span class="pre">9,</span> <span class="pre">9]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/make_test_cell.html#test_cell_n3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.make_test_cell.test_cell_n3" title="Permalink to this definition">¶</a></dt>
<dd><p>Take ASE Diamond structure, input into PySCF and run</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.make_test_cell.test_cell_n3_diffuse">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.make_test_cell.</span></span><span class="sig-name descname"><span class="pre">test_cell_n3_diffuse</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/make_test_cell.html#test_cell_n3_diffuse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.make_test_cell.test_cell_n3_diffuse" title="Permalink to this definition">¶</a></dt>
<dd><p>Take ASE Diamond structure, input into PySCF and run</p>
</dd></dl>
</section>
<section id="module-pyscf.pbc.tools.pbc">
<span id="pyscf-pbc-tools-pbc-module"></span><h2 id="module-pyscf.pbc.tools.pbc">pyscf.pbc.tools.pbc module<a class="headerlink" href="#module-pyscf.pbc.tools.pbc" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.pbc.cell_plus_imgs">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.pbc.</span></span><span class="sig-name descname"><span class="pre">cell_plus_imgs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nimgs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/pbc.html#cell_plus_imgs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.pbc.cell_plus_imgs" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a supercell via nimgs[i] in each +/- direction, as in get_lattice_Ls().
Note this function differs from <a href="#id1"><span class="problematic" id="id2">:fun:`super_cell`</span></a> that super_cell only
stacks the images in + direction.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code>
nimgs : (3,) array</p>
</dd>
<dt>Returns:</dt><dd><p>supcell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.pbc.cutoff_to_gs">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.pbc.</span></span><span class="sig-name descname"><span class="pre">cutoff_to_gs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/pbc.html#cutoff_to_gs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.pbc.cutoff_to_gs" title="Permalink to this definition">¶</a></dt>
<dd><p>Deprecated.  Replaced by function cutoff_to_mesh.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.pbc.cutoff_to_mesh">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.pbc.</span></span><span class="sig-name descname"><span class="pre">cutoff_to_mesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/pbc.html#cutoff_to_mesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.pbc.cutoff_to_mesh" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert KE cutoff to FFT-mesh</p>
<blockquote>
<div><p>uses KE = k^2 / 2, where k_max ~ pi / grid_spacing</p>
</div></blockquote>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>a<span class="classifier">(3,3) ndarray</span></dt><dd><p>The real-space unit cell lattice vectors. Each row represents a
lattice vector.</p>
</dd>
<dt>cutoff<span class="classifier">float</span></dt><dd><p>KE energy cutoff in a.u.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>mesh : (3,) array</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.pbc.fft">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.pbc.</span></span><span class="sig-name descname"><span class="pre">fft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/pbc.html#fft"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.pbc.fft" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform the 3D FFT from real (R) to reciprocal (G) space.</p>
<p>After FFT, (u, v, w) -&gt; (j, k, l).
(jkl) is in the index order of Gv.</p>
<p>FFT normalization factor is 1., as in MH and in <cite>numpy.fft</cite>.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>f<span class="classifier">(nx*ny*nz,) ndarray</span></dt><dd><p>The function to be FFT’d, flattened to a 1D array corresponding
to the index order of <code class="xref py py-func docutils literal notranslate"><span class="pre">cartesian_prod()</span></code>.</p>
</dd>
<dt>mesh<span class="classifier">(3,) ndarray of ints (= nx,ny,nz)</span></dt><dd><p>The number G-vectors along each direction.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>(nx*ny*nz,) ndarray</dt><dd><p>The FFT 1D array in same index order as Gv (natural order of
numpy.fft).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.pbc.fftk">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.pbc.</span></span><span class="sig-name descname"><span class="pre">fftk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expmikr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/pbc.html#fftk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.pbc.fftk" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform the 3D FFT of a real-space function which is (periodic*e^{ikr}).</p>
<p>fk(k+G) = sum_r fk(r) e^{-i(k+G)r} = sum_r [f(k)e^{-ikr}] e^{-iGr}</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.pbc.get_coulG">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.pbc.</span></span><span class="sig-name descname"><span class="pre">get_coulG</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.,</span> <span class="pre">0.,</span> <span class="pre">0.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Gv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wrap_around</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/pbc.html#get_coulG"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.pbc.get_coulG" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the Coulomb kernel for all G-vectors, handling G=0 and exchange.</p>
<dl>
<dt>Args:</dt><dd><dl class="simple">
<dt>k<span class="classifier">(3,) ndarray</span></dt><dd><p>k-point</p>
</dd>
<dt>exx<span class="classifier">bool or str</span></dt><dd><p>Whether this is an exchange matrix element.</p>
</dd>
</dl>
<p>mf : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">SCF</span></code></p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>coulG<span class="classifier">(ngrids,) ndarray</span></dt><dd><p>The Coulomb kernel.</p>
</dd>
<dt>mesh<span class="classifier">(3,) ndarray of ints (= nx,ny,nz)</span></dt><dd><p>The number G-vectors along each direction.</p>
</dd>
<dt>omega<span class="classifier">float</span></dt><dd><p>Enable Coulomb kernel erf(<a href="#id3"><span class="problematic" id="id4">|</span></a>omega|*r12)/r12 if omega &gt; 0
and erfc(<a href="#id5"><span class="problematic" id="id6">|</span></a>omega|*r12)/r12 if omega &lt; 0.
Note this parameter is slightly different to setting cell.omega
for the treatment of exxdiv (at G0).  cell.omega affects Ewald
probe charge at G0. It is used mostly with RSH functional for
the long-range part of HF exchange. This parameter is used by
real-space JK builder which requires Ewald probe charge to be
computed with regular Coulomb interaction (1/r12) while the rest
coulG is scaled as long-range Coulomb kernel.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.pbc.get_lattice_Ls">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.pbc.</span></span><span class="sig-name descname"><span class="pre">get_lattice_Ls</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nimgs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/pbc.html#get_lattice_Ls"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.pbc.get_lattice_Ls" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the (Cartesian, unitful) lattice translation vectors for nearby images.
The translation vectors can be used for the lattice summation.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.pbc.get_monkhorst_pack_size">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.pbc.</span></span><span class="sig-name descname"><span class="pre">get_monkhorst_pack_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/pbc.html#get_monkhorst_pack_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.pbc.get_monkhorst_pack_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.pbc.gs_to_cutoff">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.pbc.</span></span><span class="sig-name descname"><span class="pre">gs_to_cutoff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/pbc.html#gs_to_cutoff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.pbc.gs_to_cutoff" title="Permalink to this definition">¶</a></dt>
<dd><p>Deprecated.  Replaced by function mesh_to_cutoff.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.pbc.ifft">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.pbc.</span></span><span class="sig-name descname"><span class="pre">ifft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/pbc.html#ifft"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.pbc.ifft" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform the 3D inverse FFT from reciprocal (G) space to real (R) space.</p>
<p>Inverse FFT normalization factor is 1./N, same as in <cite>numpy.fft</cite> but
<strong>different</strong> from MH (they use 1.).</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>g<span class="classifier">(nx*ny*nz,) ndarray</span></dt><dd><p>The function to be inverse FFT’d, flattened to a 1D array
corresponding to the index order of <cite>span3</cite>.</p>
</dd>
<dt>mesh<span class="classifier">(3,) ndarray of ints (= nx,ny,nz)</span></dt><dd><p>The number G-vectors along each direction.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>(nx*ny*nz,) ndarray</dt><dd><p>The inverse FFT 1D array in same index order as Gv (natural order
of numpy.fft).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.pbc.ifftk">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.pbc.</span></span><span class="sig-name descname"><span class="pre">ifftk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expikr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/pbc.html#ifftk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.pbc.ifftk" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform the 3D inverse FFT of f(k+G) into a function which is (periodic*e^{ikr}).</p>
<p>fk(r) = (1/Ng) sum_G fk(k+G) e^{i(k+G)r} = (1/Ng) sum_G [fk(k+G)e^{iGr}] e^{ikr}</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.pbc.madelung">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.pbc.</span></span><span class="sig-name descname"><span class="pre">madelung</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/pbc.html#madelung"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.pbc.madelung" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.pbc.mesh_to_cutoff">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.pbc.</span></span><span class="sig-name descname"><span class="pre">mesh_to_cutoff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/pbc.html#mesh_to_cutoff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.pbc.mesh_to_cutoff" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert #grid points to KE cutoff</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.pbc.precompute_exx">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.pbc.</span></span><span class="sig-name descname"><span class="pre">precompute_exx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/pbc.html#precompute_exx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.pbc.precompute_exx" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.pbc.super_cell">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.pbc.</span></span><span class="sig-name descname"><span class="pre">super_cell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncopy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/pbc.html#super_cell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.pbc.super_cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an ncopy[0] x ncopy[1] x ncopy[2] supercell of the input cell
Note this function differs from <a href="#id7"><span class="problematic" id="id8">:fun:`cell_plus_imgs`</span></a> that cell_plus_imgs
creates images in both +/- direction.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code>
ncopy : (3,) array</p>
</dd>
<dt>Returns:</dt><dd><p>supcell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
</dd>
</dl>
</dd></dl>
</section>
<section id="pyscf-pbc-tools-pyscf-ase-module">
<h2 id="pyscf-pbc-tools-pyscf-ase-module">pyscf.pbc.tools.pyscf_ase module<a class="headerlink" href="#pyscf-pbc-tools-pyscf-ase-module" title="Permalink to this headline">¶</a></h2>
</section>
<section id="pyscf-pbc-tools-pywannier90-module">
<h2 id="pyscf-pbc-tools-pywannier90-module">pyscf.pbc.tools.pywannier90 module<a class="headerlink" href="#pyscf-pbc-tools-pywannier90-module" title="Permalink to this headline">¶</a></h2>
</section>
<section id="module-pyscf.pbc.tools.tril">
<span id="pyscf-pbc-tools-tril-module"></span><h2 id="module-pyscf.pbc.tools.tril">pyscf.pbc.tools.tril module<a class="headerlink" href="#module-pyscf.pbc.tools.tril" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.tril.tril_index">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.tril.</span></span><span class="sig-name descname"><span class="pre">tril_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ki</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/tril.html#tril_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.tril.tril_index" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.tools.tril.unpack_tril">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.tools.tril.</span></span><span class="sig-name descname"><span class="pre">unpack_tril</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nkpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ks</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/tools/tril.html#unpack_tril"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.tools.tril.unpack_tril" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
</section>
<section id="module-pyscf.pbc.tools">
<span id="module-contents"></span><h2 id="module-pyscf.pbc.tools">Module contents<a class="headerlink" href="#module-pyscf.pbc.tools" title="Permalink to this headline">¶</a></h2>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="pyscf.pbc.tdscf.html" title="pyscf.pbc.tdscf package"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> pyscf.pbc.tdscf package </span>
              </div>
            </a>
          
          
            <a href="pyscf.pbc.x2c.html" title="pyscf.pbc.x2c package"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> pyscf.pbc.x2c package </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2015-2021, The PySCF Developers.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 4.0.1.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>