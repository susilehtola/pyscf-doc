
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>pyscf.pbc.dft package &#8212; PySCF</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/pyscf.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="shortcut icon" href="../_static/favicon-32x32.png"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="pyscf.pbc.eph package" href="pyscf.pbc.eph.html" />
    <link rel="prev" title="pyscf.pbc.df package" href="pyscf.pbc.df.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=pyscf data-md-color-accent=pyscf>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#pyscf_api_docs/pyscf.pbc.dft" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="PySCF"
           class="md-header-nav__button md-logo">
          
              <img src="../_static/pyscf-logo-white.svg" height="26"
                   alt="PySCF logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">PySCF 2.0</span>
          <span class="md-header-nav__topic"> pyscf.pbc.dft package </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/pyscf/pyscf/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PySCF
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../"versions.json"",
        target_loc = "../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
            
            <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">Home</a></li>
            
            <li class="md-tabs__item"><a href="../install.html" class="md-tabs__link">Install</a></li>
            
            <li class="md-tabs__item"><a href="../quickstart.html" class="md-tabs__link">Quickstart</a></li>
            
            <li class="md-tabs__item"><a href="../user.html" class="md-tabs__link">User Guide</a></li>
            
            <li class="md-tabs__item"><a href="../develop.html" class="md-tabs__link">Developer Guide</a></li>
            
            <li class="md-tabs__item"><a href="modules.html" class="md-tabs__link">API</a></li>
            
            <li class="md-tabs__item"><a href="../about.html" class="md-tabs__link">About</a></li>
          <li class="md-tabs__item"><a href="pyscf.html" class="md-tabs__link">pyscf package</a></li>
          <li class="md-tabs__item"><a href="pyscf.pbc.html" class="md-tabs__link">pyscf.pbc package</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="PySCF" class="md-nav__button md-logo">
      
        <img src="../_static/pyscf-logo-white.svg" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="PySCF">PySCF 2.0</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/pyscf/pyscf/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    PySCF
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="../install.html" class="md-nav__link">Install</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../quickstart.html" class="md-nav__link">Quickstart</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../user.html" class="md-nav__link">User Guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../develop.html" class="md-nav__link">Developer Guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pyscf.html" class="md-nav__link">API</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="pyscf.html#subpackages" class="md-nav__link">Subpackages</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pyscf.html#submodules" class="md-nav__link">Submodules</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pyscf.html#module-pyscf.post_scf" class="md-nav__link">pyscf.post_scf module</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pyscf.html#module-pyscf" class="md-nav__link">Module contents</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../about.html" class="md-nav__link">About</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#pyscf-api-docs-pyscf-pbc-dft--page-root" class="md-nav__link">pyscf.pbc.dft package</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#submodules" class="md-nav__link">Submodules</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.pbc.dft.cdft" class="md-nav__link">pyscf.pbc.dft.cdft module</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.pbc.dft.gen_grid" class="md-nav__link">pyscf.pbc.dft.gen_grid module</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.pbc.dft.krks" class="md-nav__link">pyscf.pbc.dft.krks module</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.pbc.dft.krkspu" class="md-nav__link">pyscf.pbc.dft.krkspu module</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.pbc.dft.kroks" class="md-nav__link">pyscf.pbc.dft.kroks module</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.pbc.dft.kuks" class="md-nav__link">pyscf.pbc.dft.kuks module</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.pbc.dft.kukspu" class="md-nav__link">pyscf.pbc.dft.kukspu module</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.pbc.dft.multigrid" class="md-nav__link">pyscf.pbc.dft.multigrid module</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.pbc.dft.numint" class="md-nav__link">pyscf.pbc.dft.numint module</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.pbc.dft.rks" class="md-nav__link">pyscf.pbc.dft.rks module</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.pbc.dft.roks" class="md-nav__link">pyscf.pbc.dft.roks module</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.pbc.dft.uks" class="md-nav__link">pyscf.pbc.dft.uks module</a>
        </li>
        <li class="md-nav__item"><a href="#module-pyscf.pbc.dft" class="md-nav__link">Module contents</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/pyscf_api_docs/pyscf.pbc.dft.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="pyscf-pbc-dft-package">
<h1 id="pyscf-api-docs-pyscf-pbc-dft--page-root">pyscf.pbc.dft package<a class="headerlink" href="#pyscf-api-docs-pyscf-pbc-dft--page-root" title="Permalink to this headline">¶</a></h1>
<section id="submodules">
<h2 id="submodules">Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</section>
<section id="module-pyscf.pbc.dft.cdft">
<span id="pyscf-pbc-dft-cdft-module"></span><h2 id="module-pyscf.pbc.dft.cdft">pyscf.pbc.dft.cdft module<a class="headerlink" href="#module-pyscf.pbc.dft.cdft" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.cdft.cdft">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.cdft.</span></span><span class="sig-name descname"><span class="pre">cdft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbital</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/cdft.html#cdft"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.cdft.cdft" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Input:</dt><dd><p>mf – a mean field object for DFT or (in principle) HF (doesn’t really matter)
shift – float – a semi aribitrary energy which displaces the selected orbitals by the diagonal
orbital – int – indicating which orbital are shifted in the selected basis
basis – 2D numpy array – the working basis in the basis of AOs from ‘cell’ (Defaults to AO basis)</p>
</dd>
<dt>Returns:</dt><dd><p>mf – converged mean field object (with AO basis)</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.cdft.fast_iao_mullikan_pop">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.cdft.</span></span><span class="sig-name descname"><span class="pre">fast_iao_mullikan_pop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/cdft.html#fast_iao_mullikan_pop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.cdft.fast_iao_mullikan_pop" title="Permalink to this definition">¶</a></dt>
<dd><p>Input: mf – a preconverged mean fild object
Returns: mullikan populaion analysis in the basisIAO a</p>
</dd></dl>
</section>
<section id="module-pyscf.pbc.dft.gen_grid">
<span id="pyscf-pbc-dft-gen-grid-module"></span><h2 id="module-pyscf.pbc.dft.gen_grid">pyscf.pbc.dft.gen_grid module<a class="headerlink" href="#module-pyscf.pbc.dft.gen_grid" title="Permalink to this headline">¶</a></h2>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gen_grid.AtomicGrids">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.gen_grid.</span></span><span class="sig-name descname"><span class="pre">AtomicGrids</span></span><a class="headerlink" href="#pyscf.pbc.dft.gen_grid.AtomicGrids" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#pyscf.pbc.dft.gen_grid.BeckeGrids" title="pyscf.pbc.dft.gen_grid.BeckeGrids"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.pbc.dft.gen_grid.BeckeGrids</span></code></a></p>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gen_grid.BeckeGrids">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.gen_grid.</span></span><span class="sig-name descname"><span class="pre">BeckeGrids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/gen_grid.html#BeckeGrids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.gen_grid.BeckeGrids" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="pyscf.dft.html#pyscf.dft.gen_grid.Grids" title="pyscf.dft.gen_grid.Grids"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.dft.gen_grid.Grids</span></code></a></p>
<p>Atomic grids for all-electron calculation.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gen_grid.BeckeGrids.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/gen_grid.html#BeckeGrids.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.gen_grid.BeckeGrids.build" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gen_grid.BeckeGrids.make_mask">
<span class="sig-name descname"><span class="pre">make_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/gen_grid.html#BeckeGrids.make_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.gen_grid.BeckeGrids.make_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Mask to indicate whether a shell is zero on grid.
The resultant mask array is an extension to the mask array used in
molecular code (see also pyscf.dft.numint.make_mask function).
For given shell ID and block ID, the value of the extended mask array
means the number of images in Ls that does not vanish.</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gen_grid.UniformGrids">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.gen_grid.</span></span><span class="sig-name descname"><span class="pre">UniformGrids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/gen_grid.html#UniformGrids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.gen_grid.UniformGrids" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="pyscf.lib.html#pyscf.lib.misc.StreamObject" title="pyscf.lib.misc.StreamObject"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.lib.misc.StreamObject</span></code></a></p>
<p>Uniform Grid class.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gen_grid.UniformGrids.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/gen_grid.html#UniformGrids.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.gen_grid.UniformGrids.build" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gen_grid.UniformGrids.coords">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">coords</span></span><a class="headerlink" href="#pyscf.pbc.dft.gen_grid.UniformGrids.coords" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gen_grid.UniformGrids.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/gen_grid.html#UniformGrids.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.gen_grid.UniformGrids.dump_flags" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gen_grid.UniformGrids.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/gen_grid.html#UniformGrids.kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.gen_grid.UniformGrids.kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Kernel function is the main driver of a method.  Every method should
define the kernel function as the entry of the calculation.  Note the
return value of kernel function is not strictly defined.  It can be
anything related to the method (such as the energy, the wave-function,
the DFT mesh grids etc.).</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gen_grid.UniformGrids.make_mask">
<span class="sig-name descname"><span class="pre">make_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/gen_grid.html#UniformGrids.make_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.gen_grid.UniformGrids.make_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Mask to indicate whether a shell is zero on grid.
The resultant mask array is an extension to the mask array used in
molecular code (see also pyscf.dft.numint.make_mask function).
For given shell ID and block ID, the value of the extended mask array
means the number of images in Ls that does not vanish.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gen_grid.UniformGrids.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/gen_grid.html#UniformGrids.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.gen_grid.UniformGrids.reset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gen_grid.UniformGrids.weights">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">weights</span></span><a class="headerlink" href="#pyscf.pbc.dft.gen_grid.UniformGrids.weights" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gen_grid.gen_becke_grids">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.gen_grid.</span></span><span class="sig-name descname"><span class="pre">gen_becke_grids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">cell</span></em>, <em class="sig-param"><span class="pre">atom_grid={}</span></em>, <em class="sig-param"><span class="pre">radi_method=&lt;function</span> <span class="pre">gauss_chebyshev&gt;</span></em>, <em class="sig-param"><span class="pre">level=3</span></em>, <em class="sig-param"><span class="pre">prune=&lt;function</span> <span class="pre">nwchem_prune&gt;</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.gen_grid.gen_becke_grids" title="Permalink to this definition">¶</a></dt>
<dd><p>real-space grids using Becke scheme</p>
<dl>
<dt>Args:</dt><dd><p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>coords<span class="classifier">(N, 3) ndarray</span></dt><dd><p>The real-space grid point coordinates.</p>
</dd>
</dl>
<p>weights : (N) ndarray</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gen_grid.get_becke_grids">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.gen_grid.</span></span><span class="sig-name descname"><span class="pre">get_becke_grids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">cell</span></em>, <em class="sig-param"><span class="pre">atom_grid={}</span></em>, <em class="sig-param"><span class="pre">radi_method=&lt;function</span> <span class="pre">gauss_chebyshev&gt;</span></em>, <em class="sig-param"><span class="pre">level=3</span></em>, <em class="sig-param"><span class="pre">prune=&lt;function</span> <span class="pre">nwchem_prune&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/gen_grid.html#get_becke_grids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.gen_grid.get_becke_grids" title="Permalink to this definition">¶</a></dt>
<dd><p>real-space grids using Becke scheme</p>
<dl>
<dt>Args:</dt><dd><p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>coords<span class="classifier">(N, 3) ndarray</span></dt><dd><p>The real-space grid point coordinates.</p>
</dd>
</dl>
<p>weights : (N) ndarray</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.gen_grid.make_mask">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.gen_grid.</span></span><span class="sig-name descname"><span class="pre">make_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/gen_grid.html#make_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.gen_grid.make_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Mask to indicate whether a shell is zero on grid.
The resultant mask array is an extension to the mask array used in
molecular code (see also pyscf.dft.numint.make_mask function).
For given shell ID and block ID, the value of the extended mask array
means the number of images in Ls that does not vanish.</p>
</dd></dl>
</section>
<section id="module-pyscf.pbc.dft.krks">
<span id="pyscf-pbc-dft-krks-module"></span><h2 id="module-pyscf.pbc.dft.krks">pyscf.pbc.dft.krks module<a class="headerlink" href="#module-pyscf.pbc.dft.krks" title="Permalink to this headline">¶</a></h2>
<p>Non-relativistic Restricted Kohn-Sham for periodic systems with k-point sampling</p>
<dl class="simple">
<dt>See Also:</dt><dd><dl class="simple">
<dt>pyscf.pbc.dft.rks.py<span class="classifier">Non-relativistic Restricted Kohn-Sham for periodic</span></dt><dd><p>systems at a single k-point</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks.KRKS">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.krks.</span></span><span class="sig-name descname"><span class="pre">KRKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.]])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ewald'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krks.html#KRKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krks.KRKS" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.pbc.dft.rks.KohnShamDFT" title="pyscf.pbc.dft.rks.KohnShamDFT"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.pbc.dft.rks.KohnShamDFT</span></code></a>, <a class="reference internal" href="pyscf.pbc.scf.html#pyscf.pbc.scf.khf.KRHF" title="pyscf.pbc.scf.khf.KRHF"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.pbc.scf.khf.KRHF</span></code></a></p>
<p>RKS class adapted for PBCs with k-point sampling.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks.KRKS.density_fit">
<span class="sig-name descname"><span class="pre">density_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">auxbasis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.krks.KRKS.density_fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks.KRKS.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krks.html#KRKS.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krks.KRKS.dump_flags" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks.KRKS.energy_elec">
<span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krks.html#KRKS.energy_elec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krks.KRKS.energy_elec" title="Permalink to this definition">¶</a></dt>
<dd><p>Following pyscf.scf.hf.energy_elec()</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks.KRKS.get_rho">
<span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.krks.KRKS.get_rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute density in real space</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks.KRKS.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.krks.KRKS.get_veff" title="Permalink to this definition">¶</a></dt>
<dd><p>Coulomb + XC functional</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a replica of pyscf.dft.rks.get_veff with kpts added.
This function will change the ks object.</p>
</div>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">RKS</span></code></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
<dt>dm<span class="classifier">ndarray or list of ndarrays</span></dt><dd><p>A density matrix or a list of density matrices</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Veff : (nkpts, nao, nao) or (<a href="#id1"><span class="problematic" id="id2">*</span></a>, nkpts, nao, nao) ndarray
Veff = J + Vxc.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks.KRKS.mix_density_fit">
<span class="sig-name descname"><span class="pre">mix_density_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">auxbasis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.krks.KRKS.mix_density_fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks.KRKS.nuc_grad_method">
<span class="sig-name descname"><span class="pre">nuc_grad_method</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krks.html#KRKS.nuc_grad_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krks.KRKS.nuc_grad_method" title="Permalink to this definition">¶</a></dt>
<dd><p>Hook to create object for analytical nuclear gradients.</p>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks.get_rho">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.krks.</span></span><span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krks.html#get_rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krks.get_rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute density in real space</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krks.get_veff">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.krks.</span></span><span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krks.html#get_veff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krks.get_veff" title="Permalink to this definition">¶</a></dt>
<dd><p>Coulomb + XC functional</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a replica of pyscf.dft.rks.get_veff with kpts added.
This function will change the ks object.</p>
</div>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">RKS</span></code></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
<dt>dm<span class="classifier">ndarray or list of ndarrays</span></dt><dd><p>A density matrix or a list of density matrices</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Veff : (nkpts, nao, nao) or (<a href="#id3"><span class="problematic" id="id4">*</span></a>, nkpts, nao, nao) ndarray
Veff = J + Vxc.</p>
</dd>
</dl>
</dd></dl>
</section>
<section id="module-pyscf.pbc.dft.krkspu">
<span id="pyscf-pbc-dft-krkspu-module"></span><h2 id="module-pyscf.pbc.dft.krkspu">pyscf.pbc.dft.krkspu module<a class="headerlink" href="#module-pyscf.pbc.dft.krkspu" title="Permalink to this headline">¶</a></h2>
<p>Restricted DFT+U with kpoint sampling.
Based on KRHF routine.</p>
<p>Refs: PRB, 1998, 57, 1505.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krkspu.KRKSpU">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.krkspu.</span></span><span class="sig-name descname"><span class="pre">KRKSpU</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.]])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ewald'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C_ao_lo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'minao'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krkspu.html#KRKSpU"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krkspu.KRKSpU" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.pbc.dft.krks.KRKS" title="pyscf.pbc.dft.krks.KRKS"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.pbc.dft.krks.KRKS</span></code></a></p>
<p>RKSpU class adapted for PBCs with k-point sampling.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krkspu.KRKSpU.energy_elec">
<span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.krkspu.KRKSpU.energy_elec" title="Permalink to this definition">¶</a></dt>
<dd><p>Electronic energy for KRKSpU.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krkspu.KRKSpU.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.krkspu.KRKSpU.get_veff" title="Permalink to this definition">¶</a></dt>
<dd><p>Coulomb + XC functional + Hubbard U terms.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a replica of pyscf.dft.rks.get_veff with kpts added.
This function will change the ks object.</p>
</div>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">RKS</span></code></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
<dt>dm<span class="classifier">ndarray or list of ndarrays</span></dt><dd><p>A density matrix or a list of density matrices</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Veff : (nkpts, nao, nao) or (<a href="#id5"><span class="problematic" id="id6">*</span></a>, nkpts, nao, nao) ndarray
Veff = J + Vxc + V_U.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krkspu.KRKSpU.nuc_grad_method">
<span class="sig-name descname"><span class="pre">nuc_grad_method</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krkspu.html#KRKSpU.nuc_grad_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krkspu.KRKSpU.nuc_grad_method" title="Permalink to this definition">¶</a></dt>
<dd><p>Hook to create object for analytical nuclear gradients.</p>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krkspu.energy_elec">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.krkspu.</span></span><span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krkspu.html#energy_elec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krkspu.energy_elec" title="Permalink to this definition">¶</a></dt>
<dd><p>Electronic energy for KRKSpU.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krkspu.format_idx">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.krkspu.</span></span><span class="sig-name descname"><span class="pre">format_idx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krkspu.html#format_idx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krkspu.format_idx" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krkspu.get_veff">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.krkspu.</span></span><span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krkspu.html#get_veff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krkspu.get_veff" title="Permalink to this definition">¶</a></dt>
<dd><p>Coulomb + XC functional + Hubbard U terms.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a replica of pyscf.dft.rks.get_veff with kpts added.
This function will change the ks object.</p>
</div>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">RKS</span></code></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
<dt>dm<span class="classifier">ndarray or list of ndarrays</span></dt><dd><p>A density matrix or a list of density matrices</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Veff : (nkpts, nao, nao) or (<a href="#id7"><span class="problematic" id="id8">*</span></a>, nkpts, nao, nao) ndarray
Veff = J + Vxc + V_U.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krkspu.make_minao_lo">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.krkspu.</span></span><span class="sig-name descname"><span class="pre">make_minao_lo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minao_ref</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krkspu.html#make_minao_lo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krkspu.make_minao_lo" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct minao local orbitals.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krkspu.mdot">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.krkspu.</span></span><span class="sig-name descname"><span class="pre">mdot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krkspu.html#mdot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krkspu.mdot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krkspu.proj_ref_ao">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.krkspu.</span></span><span class="sig-name descname"><span class="pre">proj_ref_ao</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'minao'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krkspu.html#proj_ref_ao"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krkspu.proj_ref_ao" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a set of reference AO spanned by the calculation basis.
Not orthogonalized.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>return_labels: if True, return the labels as well.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.krkspu.set_U">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.krkspu.</span></span><span class="sig-name descname"><span class="pre">set_U</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U_val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/krkspu.html#set_U"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.krkspu.set_U" title="Permalink to this definition">¶</a></dt>
<dd><p>Regularize the U_idx and U_val to each atom,
and set ks.U_idx, ks.U_val, ks.U_lab.</p>
</dd></dl>
</section>
<section id="module-pyscf.pbc.dft.kroks">
<span id="pyscf-pbc-dft-kroks-module"></span><h2 id="module-pyscf.pbc.dft.kroks">pyscf.pbc.dft.kroks module<a class="headerlink" href="#module-pyscf.pbc.dft.kroks" title="Permalink to this headline">¶</a></h2>
<p>Restricted open-shell Kohn-Sham for periodic systems with k-point sampling</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kroks.KROKS">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.kroks.</span></span><span class="sig-name descname"><span class="pre">KROKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.]])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ewald'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kroks.html#KROKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kroks.KROKS" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.pbc.dft.rks.KohnShamDFT" title="pyscf.pbc.dft.rks.KohnShamDFT"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.pbc.dft.rks.KohnShamDFT</span></code></a>, <a class="reference internal" href="pyscf.pbc.scf.html#pyscf.pbc.scf.krohf.KROHF" title="pyscf.pbc.scf.krohf.KROHF"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.pbc.scf.krohf.KROHF</span></code></a></p>
<p>RKS class adapted for PBCs with k-point sampling.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kroks.KROKS.density_fit">
<span class="sig-name descname"><span class="pre">density_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">auxbasis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kroks.KROKS.density_fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kroks.KROKS.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kroks.html#KROKS.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kroks.KROKS.dump_flags" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kroks.KROKS.energy_elec">
<span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kroks.KROKS.energy_elec" title="Permalink to this definition">¶</a></dt>
<dd><p>Following pyscf.scf.hf.energy_elec()</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kroks.KROKS.get_rho">
<span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kroks.KROKS.get_rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute density in real space</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kroks.KROKS.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kroks.KROKS.get_veff" title="Permalink to this definition">¶</a></dt>
<dd><p>Coulomb + XC functional for UKS.  See pyscf/pbc/dft/uks.py
<a class="reference internal" href="#pyscf.pbc.dft.kroks.get_veff" title="pyscf.pbc.dft.kroks.get_veff"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_veff()</span></code></a> fore more details.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kroks.KROKS.mix_density_fit">
<span class="sig-name descname"><span class="pre">mix_density_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">auxbasis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kroks.KROKS.mix_density_fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kroks.get_veff">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.kroks.</span></span><span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kroks.html#get_veff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kroks.get_veff" title="Permalink to this definition">¶</a></dt>
<dd><p>Coulomb + XC functional for UKS.  See pyscf/pbc/dft/uks.py
<a class="reference internal" href="#pyscf.pbc.dft.kroks.get_veff" title="pyscf.pbc.dft.kroks.get_veff"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_veff()</span></code></a> fore more details.</p>
</dd></dl>
</section>
<section id="module-pyscf.pbc.dft.kuks">
<span id="pyscf-pbc-dft-kuks-module"></span><h2 id="module-pyscf.pbc.dft.kuks">pyscf.pbc.dft.kuks module<a class="headerlink" href="#module-pyscf.pbc.dft.kuks" title="Permalink to this headline">¶</a></h2>
<p>Non-relativistic Restricted Kohn-Sham for periodic systems with k-point sampling</p>
<dl class="simple">
<dt>See Also:</dt><dd><dl class="simple">
<dt>pyscf.pbc.dft.rks.py<span class="classifier">Non-relativistic Restricted Kohn-Sham for periodic</span></dt><dd><p>systems at a single k-point</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks.KUKS">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.kuks.</span></span><span class="sig-name descname"><span class="pre">KUKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.]])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ewald'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kuks.html#KUKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kuks.KUKS" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.pbc.dft.rks.KohnShamDFT" title="pyscf.pbc.dft.rks.KohnShamDFT"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.pbc.dft.rks.KohnShamDFT</span></code></a>, <a class="reference internal" href="pyscf.pbc.scf.html#pyscf.pbc.scf.kuhf.KUHF" title="pyscf.pbc.scf.kuhf.KUHF"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.pbc.scf.kuhf.KUHF</span></code></a></p>
<p>RKS class adapted for PBCs with k-point sampling.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks.KUKS.density_fit">
<span class="sig-name descname"><span class="pre">density_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">auxbasis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kuks.KUKS.density_fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks.KUKS.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kuks.html#KUKS.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kuks.KUKS.dump_flags" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks.KUKS.energy_elec">
<span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kuks.KUKS.energy_elec" title="Permalink to this definition">¶</a></dt>
<dd><p>Following pyscf.scf.hf.energy_elec()</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks.KUKS.get_rho">
<span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kuks.KUKS.get_rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute density in real space</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks.KUKS.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kuks.KUKS.get_veff" title="Permalink to this definition">¶</a></dt>
<dd><p>Coulomb + XC functional for UKS.  See pyscf/pbc/dft/uks.py
<a class="reference internal" href="#pyscf.pbc.dft.kuks.get_veff" title="pyscf.pbc.dft.kuks.get_veff"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_veff()</span></code></a> fore more details.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks.KUKS.mix_density_fit">
<span class="sig-name descname"><span class="pre">mix_density_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">auxbasis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kuks.KUKS.mix_density_fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks.KUKS.nuc_grad_method">
<span class="sig-name descname"><span class="pre">nuc_grad_method</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kuks.html#KUKS.nuc_grad_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kuks.KUKS.nuc_grad_method" title="Permalink to this definition">¶</a></dt>
<dd><p>Hook to create object for analytical nuclear gradients.</p>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks.energy_elec">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.kuks.</span></span><span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kuks.html#energy_elec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kuks.energy_elec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks.get_rho">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.kuks.</span></span><span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kuks.html#get_rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kuks.get_rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute density in real space</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kuks.get_veff">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.kuks.</span></span><span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kuks.html#get_veff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kuks.get_veff" title="Permalink to this definition">¶</a></dt>
<dd><p>Coulomb + XC functional for UKS.  See pyscf/pbc/dft/uks.py
<a class="reference internal" href="#pyscf.pbc.dft.kuks.get_veff" title="pyscf.pbc.dft.kuks.get_veff"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_veff()</span></code></a> fore more details.</p>
</dd></dl>
</section>
<section id="module-pyscf.pbc.dft.kukspu">
<span id="pyscf-pbc-dft-kukspu-module"></span><h2 id="module-pyscf.pbc.dft.kukspu">pyscf.pbc.dft.kukspu module<a class="headerlink" href="#module-pyscf.pbc.dft.kukspu" title="Permalink to this headline">¶</a></h2>
<p>Unrestricted DFT+U with kpoint sampling.
Based on KUHF routine.</p>
<p>Refs: PRB, 1998, 57, 1505.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kukspu.KUKSpU">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.kukspu.</span></span><span class="sig-name descname"><span class="pre">KUKSpU</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.]])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ewald'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C_ao_lo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'minao'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kukspu.html#KUKSpU"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kukspu.KUKSpU" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.pbc.dft.kuks.KUKS" title="pyscf.pbc.dft.kuks.KUKS"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.pbc.dft.kuks.KUKS</span></code></a></p>
<p>UKSpU class adapted for PBCs with k-point sampling.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kukspu.KUKSpU.energy_elec">
<span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kukspu.KUKSpU.energy_elec" title="Permalink to this definition">¶</a></dt>
<dd><p>Electronic energy for KUKSpU.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kukspu.KUKSpU.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.kukspu.KUKSpU.get_veff" title="Permalink to this definition">¶</a></dt>
<dd><p>Coulomb + XC functional + (Hubbard - double counting) for KUKSpU.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kukspu.KUKSpU.nuc_grad_method">
<span class="sig-name descname"><span class="pre">nuc_grad_method</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kukspu.html#KUKSpU.nuc_grad_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kukspu.KUKSpU.nuc_grad_method" title="Permalink to this definition">¶</a></dt>
<dd><p>Hook to create object for analytical nuclear gradients.</p>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kukspu.energy_elec">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.kukspu.</span></span><span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kukspu.html#energy_elec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kukspu.energy_elec" title="Permalink to this definition">¶</a></dt>
<dd><p>Electronic energy for KUKSpU.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.kukspu.get_veff">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.kukspu.</span></span><span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/kukspu.html#get_veff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.kukspu.get_veff" title="Permalink to this definition">¶</a></dt>
<dd><p>Coulomb + XC functional + (Hubbard - double counting) for KUKSpU.</p>
</dd></dl>
</section>
<section id="module-pyscf.pbc.dft.multigrid">
<span id="pyscf-pbc-dft-multigrid-module"></span><h2 id="module-pyscf.pbc.dft.multigrid">pyscf.pbc.dft.multigrid module<a class="headerlink" href="#module-pyscf.pbc.dft.multigrid" title="Permalink to this headline">¶</a></h2>
<p>Multigrid to compute DFT integrals</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.dft.multigrid.MultiGridFFTDF">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.multigrid.</span></span><span class="sig-name descname"><span class="pre">MultiGridFFTDF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.]])</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/multigrid.html#MultiGridFFTDF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.multigrid.MultiGridFFTDF" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="pyscf.pbc.df.html#pyscf.pbc.df.fft.FFTDF" title="pyscf.pbc.df.fft.FFTDF"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.pbc.df.fft.FFTDF</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.multigrid.MultiGridFFTDF.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/multigrid.html#MultiGridFFTDF.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.multigrid.MultiGridFFTDF.build" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.multigrid.MultiGridFFTDF.get_jk">
<span class="sig-name descname"><span class="pre">get_jk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ewald'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/multigrid.html#MultiGridFFTDF.get_jk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.multigrid.MultiGridFFTDF.get_jk" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.multigrid.MultiGridFFTDF.get_nuc">
<span class="sig-name descname"><span class="pre">get_nuc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.multigrid.MultiGridFFTDF.get_nuc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.multigrid.MultiGridFFTDF.get_pp">
<span class="sig-name descname"><span class="pre">get_pp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.multigrid.MultiGridFFTDF.get_pp" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the periodic pseudotential nuc-el AO matrix, with G=0 removed.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.multigrid.MultiGridFFTDF.get_rho">
<span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.]])</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.multigrid.MultiGridFFTDF.get_rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Density in real space</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.multigrid.MultiGridFFTDF.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/multigrid.html#MultiGridFFTDF.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.multigrid.MultiGridFFTDF.reset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.multigrid.cache_xc_kernel">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.multigrid.</span></span><span class="sig-name descname"><span class="pre">cache_xc_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mydf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/multigrid.html#cache_xc_kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.multigrid.cache_xc_kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the 0th order density, Vxc and fxc.  They can be used in TDDFT,
DFT hessian module etc.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.multigrid.eval_mat">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.multigrid.</span></span><span class="sig-name descname"><span class="pre">eval_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">submesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/multigrid.html#eval_mat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.multigrid.eval_mat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.multigrid.eval_rho">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.multigrid.</span></span><span class="sig-name descname"><span class="pre">eval_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">submesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_imag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/multigrid.html#eval_rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.multigrid.eval_rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Collocate the <em>real</em> density (opt. gradients) on the real-space grid.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.multigrid.get_j_kpts">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.multigrid.</span></span><span class="sig-name descname"><span class="pre">get_j_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mydf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.]])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/multigrid.html#get_j_kpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.multigrid.get_j_kpts" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the Coulomb (J) AO matrix at sampled k-points.</p>
<dl>
<dt>Args:</dt><dd><dl class="simple">
<dt>dm_kpts<span class="classifier">(nkpts, nao, nao) ndarray or a list of (nkpts,nao,nao) ndarray</span></dt><dd><p>Density matrix at each k-point.  If a list of k-point DMs, eg,
UHF alpha and beta DM, the alpha and beta DMs are contracted
separately.</p>
</dd>
</dl>
<p>kpts : (nkpts, 3) ndarray</p>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>kpts_band<span class="classifier">(3,) ndarray or (<a href="#id9"><span class="problematic" id="id10">*</span></a>,3) ndarray</span></dt><dd><p>A list of arbitrary “band” k-points at which to evalute the matrix.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>vj : (nkpts, nao, nao) ndarray
or list of vj if the input dm_kpts is a list of DMs</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.multigrid.get_nuc">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.multigrid.</span></span><span class="sig-name descname"><span class="pre">get_nuc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mydf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/multigrid.html#get_nuc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.multigrid.get_nuc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.multigrid.get_pp">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.multigrid.</span></span><span class="sig-name descname"><span class="pre">get_pp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mydf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/multigrid.html#get_pp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.multigrid.get_pp" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the periodic pseudotential nuc-el AO matrix, with G=0 removed.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.multigrid.get_rho">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.multigrid.</span></span><span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mydf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.]])</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/multigrid.html#get_rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.multigrid.get_rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Density in real space</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.multigrid.multi_grids_tasks">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.multigrid.</span></span><span class="sig-name descname"><span class="pre">multi_grids_tasks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fft_mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/multigrid.html#multi_grids_tasks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.multigrid.multi_grids_tasks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.multigrid.multi_grids_tasks_for_ke_cut">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.multigrid.</span></span><span class="sig-name descname"><span class="pre">multi_grids_tasks_for_ke_cut</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fft_mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/multigrid.html#multi_grids_tasks_for_ke_cut"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.multigrid.multi_grids_tasks_for_ke_cut" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.multigrid.multi_grids_tasks_for_rcut">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.multigrid.</span></span><span class="sig-name descname"><span class="pre">multi_grids_tasks_for_rcut</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fft_mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/multigrid.html#multi_grids_tasks_for_rcut"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.multigrid.multi_grids_tasks_for_rcut" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.multigrid.multigrid">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.multigrid.</span></span><span class="sig-name descname"><span class="pre">multigrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/multigrid.html#multigrid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.multigrid.multigrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Use MultiGridFFTDF to replace the default FFTDF integration method in
the DFT object.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.multigrid.nr_rks">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.multigrid.</span></span><span class="sig-name descname"><span class="pre">nr_rks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mydf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/multigrid.html#nr_rks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.multigrid.nr_rks" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the XC energy and RKS XC matrix at sampled k-points.
multigrid version of function pbc.dft.numint.nr_rks.</p>
<dl>
<dt>Args:</dt><dd><dl class="simple">
<dt>dm_kpts<span class="classifier">(nkpts, nao, nao) ndarray or a list of (nkpts,nao,nao) ndarray</span></dt><dd><p>Density matrix at each k-point.</p>
</dd>
</dl>
<p>kpts : (nkpts, 3) ndarray</p>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>kpts_band<span class="classifier">(3,) ndarray or (<a href="#id11"><span class="problematic" id="id12">*</span></a>,3) ndarray</span></dt><dd><p>A list of arbitrary “band” k-points at which to evalute the matrix.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>exc : XC energy
nelec : number of electrons obtained from the numerical integration
veff : (nkpts, nao, nao) ndarray</p>
<blockquote>
<div><p>or list of veff if the input dm_kpts is a list of DMs</p>
</div></blockquote>
<dl class="simple">
<dt>vj<span class="classifier">(nkpts, nao, nao) ndarray</span></dt><dd><p>or list of vj if the input dm_kpts is a list of DMs</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.multigrid.nr_rks_fxc">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.multigrid.</span></span><span class="sig-name descname"><span class="pre">nr_rks_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mydf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/multigrid.html#nr_rks_fxc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.multigrid.nr_rks_fxc" title="Permalink to this definition">¶</a></dt>
<dd><p>multigrid version of function pbc.dft.numint.nr_rks_fxc</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.multigrid.nr_rks_fxc_st">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.multigrid.</span></span><span class="sig-name descname"><span class="pre">nr_rks_fxc_st</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mydf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms_alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">singlet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/multigrid.html#nr_rks_fxc_st"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.multigrid.nr_rks_fxc_st" title="Permalink to this definition">¶</a></dt>
<dd><p>multigrid version of function pbc.dft.numint.nr_rks_fxc_st</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.multigrid.nr_uks">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.multigrid.</span></span><span class="sig-name descname"><span class="pre">nr_uks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mydf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/multigrid.html#nr_uks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.multigrid.nr_uks" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the XC energy and UKS XC matrix at sampled k-points.
multigrid version of function pbc.dft.numint.nr_uks</p>
<dl>
<dt>Args:</dt><dd><dl class="simple">
<dt>dm_kpts<span class="classifier">(nkpts, nao, nao) ndarray or a list of (nkpts,nao,nao) ndarray</span></dt><dd><p>Density matrix at each k-point.</p>
</dd>
</dl>
<p>kpts : (nkpts, 3) ndarray</p>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>kpts_band<span class="classifier">(3,) ndarray or (<a href="#id13"><span class="problematic" id="id14">*</span></a>,3) ndarray</span></dt><dd><p>A list of arbitrary “band” k-points at which to evalute the matrix.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>exc : XC energy
nelec : number of electrons obtained from the numerical integration
veff : (2, nkpts, nao, nao) ndarray</p>
<blockquote>
<div><p>or list of veff if the input dm_kpts is a list of DMs</p>
</div></blockquote>
<dl class="simple">
<dt>vj<span class="classifier">(nkpts, nao, nao) ndarray</span></dt><dd><p>or list of vj if the input dm_kpts is a list of DMs</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.multigrid.nr_uks_fxc">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.multigrid.</span></span><span class="sig-name descname"><span class="pre">nr_uks_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mydf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/multigrid.html#nr_uks_fxc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.multigrid.nr_uks_fxc" title="Permalink to this definition">¶</a></dt>
<dd><p>multigrid version of function pbc.dft.numint.nr_uks_fxc</p>
</dd></dl>
</section>
<section id="module-pyscf.pbc.dft.numint">
<span id="pyscf-pbc-dft-numint-module"></span><h2 id="module-pyscf.pbc.dft.numint">pyscf.pbc.dft.numint module<a class="headerlink" href="#module-pyscf.pbc.dft.numint" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.KNumInt">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.numint.</span></span><span class="sig-name descname"><span class="pre">KNumInt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.]])</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#KNumInt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.KNumInt" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="pyscf.dft.html#pyscf.dft.numint.NumInt" title="pyscf.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.dft.numint.NumInt</span></code></a></p>
<p>Generalization of pyscf’s NumInt class for k-point sampling and
periodic images.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.KNumInt.block_loop">
<span class="sig-name descname"><span class="pre">block_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.]])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blksize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#KNumInt.block_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.KNumInt.block_loop" title="Permalink to this definition">¶</a></dt>
<dd><p>Define this macro to loop over grids by blocks.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.KNumInt.cache_xc_kernel">
<span class="sig-name descname"><span class="pre">cache_xc_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint.KNumInt.cache_xc_kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the 0th order density, Vxc and fxc.  They can be used in TDDFT,
DFT hessian module etc.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.KNumInt.eval_ao">
<span class="sig-name descname"><span class="pre">eval_ao</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.]])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#KNumInt.eval_ao"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.KNumInt.eval_ao" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate AO function value on the given grids.</p>
<dl>
<dt>Args:</dt><dd><p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl class="simple">
<dt>coords<span class="classifier">2D array, shape (N,3)</span></dt><dd><p>The coordinates of the grids.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>deriv<span class="classifier">int</span></dt><dd><p>AO derivative order.  It affects the shape of the return array.
If deriv=0, the returned AO values are stored in a (N,nao) array.
Otherwise the AO values are stored in an array of shape (M,N,nao).
Here N is the number of grids, nao is the number of AO functions,
M is the size associated to the derivative deriv.</p>
</dd>
<dt>relativity<span class="classifier">bool</span></dt><dd><p>No effects.</p>
</dd>
<dt>shls_slice<span class="classifier">2-element list</span></dt><dd><p>(shl_start, shl_end).
If given, only part of AOs (shl_start &lt;= shell_id &lt; shl_end) are
evaluated.  By default, all shells defined in mol will be evaluated.</p>
</dd>
<dt>non0tab<span class="classifier">2D bool array</span></dt><dd><p>mask array to indicate whether the AO values are zero.  The mask
array can be obtained by calling <a class="reference internal" href="#pyscf.pbc.dft.numint.KNumInt.make_mask" title="pyscf.pbc.dft.numint.KNumInt.make_mask"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_mask()</span></code></a></p>
</dd>
<dt>out<span class="classifier">ndarray</span></dt><dd><p>If provided, results are written into this array.</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>2D array of shape (N,nao) for AO values if deriv = 0.
Or 3D array of shape (:,N,nao) for AO values and AO derivatives if deriv &gt; 0.
In the 3D array, the first (N,nao) elements are the AO values,
followed by (3,N,nao) for x,y,z compoents;
Then 2nd derivatives (6,N,nao) for xx, xy, xz, yy, yz, zz;
Then 3rd derivatives (10,N,nao) for xxx, xxy, xxz, xyy, xyz, xzz, yyy, yyz, yzz, zzz;
…</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'O 0 0 0; H 0 0 1; H 0 1 0'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'ccpvdz'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coords</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>  <span class="c1"># 100 random points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span> <span class="o">=</span> <span class="n">eval_ao</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">coords</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ao_value</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(100, 24)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span> <span class="o">=</span> <span class="n">eval_ao</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shls_slice</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ao_value</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(4, 100, 7)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span> <span class="o">=</span> <span class="n">eval_ao</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">shls_slice</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ao_value</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(10, 100, 7)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.KNumInt.eval_mat">
<span class="sig-name descname"><span class="pre">eval_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao_kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#KNumInt.eval_mat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.KNumInt.eval_mat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.KNumInt.eval_rho">
<span class="sig-name descname"><span class="pre">eval_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao_kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#KNumInt.eval_rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.KNumInt.eval_rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Collocate the <em>real</em> density (opt. gradients) on the real-space grid.</p>
<dl>
<dt>Args:</dt><dd><p>cell : Mole or Cell object
ao_kpts : (nkpts, ngrids, nao) ndarray</p>
<blockquote>
<div><p>AO values at each k-point</p>
</div></blockquote>
<dl class="simple">
<dt>dm_kpts: (nkpts, nao, nao) ndarray</dt><dd><p>Density matrix at each k-point</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>rhoR : (ngrids,) ndarray</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.KNumInt.eval_rho2">
<span class="sig-name descname"><span class="pre">eval_rho2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao_kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff_kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ_kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#KNumInt.eval_rho2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.KNumInt.eval_rho2" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the electron density for LDA functional, and the density
derivatives for GGA functional.  This function has the same functionality
as <a class="reference internal" href="#pyscf.pbc.dft.numint.eval_rho" title="pyscf.pbc.dft.numint.eval_rho"><code class="xref py py-func docutils literal notranslate"><span class="pre">eval_rho()</span></code></a> except that the density are evaluated based on orbital
coefficients and orbital occupancy.  It is more efficient than
<a class="reference internal" href="#pyscf.pbc.dft.numint.eval_rho" title="pyscf.pbc.dft.numint.eval_rho"><code class="xref py py-func docutils literal notranslate"><span class="pre">eval_rho()</span></code></a> in most scenario.</p>
<dl>
<dt>Args:</dt><dd><p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl class="simple">
<dt>ao<span class="classifier">2D array of shape (N,nao) for LDA, 3D array of shape (4,N,nao) for GGA</span></dt><dd><p>or (5,N,nao) for meta-GGA.  N is the number of grids, nao is the
number of AO functions.  If xctype is GGA, ao[0] is AO value
and ao[1:3] are the AO gradients.  If xctype is meta-GGA, ao[4:10]
are second derivatives of ao values.</p>
</dd>
<dt>dm<span class="classifier">2D array</span></dt><dd><p>Density matrix</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>non0tab<span class="classifier">2D bool array</span></dt><dd><p>mask array to indicate whether the AO values are zero.  The mask
array can be obtained by calling <a class="reference internal" href="#pyscf.pbc.dft.numint.KNumInt.make_mask" title="pyscf.pbc.dft.numint.KNumInt.make_mask"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_mask()</span></code></a></p>
</dd>
<dt>xctype<span class="classifier">str</span></dt><dd><p>LDA/GGA/mGGA.  It affects the shape of the return density.</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>1D array of size N to store electron density if xctype = LDA;  2D array
of (4,N) to store density and “density derivatives” for x,y,z components
if xctype = GGA;  (6,N) array for meta-GGA, where last two rows are
nabla^2 rho and tau = 1/2(nabla f)^2</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.KNumInt.get_rho">
<span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.]])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint.KNumInt.get_rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Density in real space</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.KNumInt.make_mask">
<span class="sig-name descname"><span class="pre">make_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#KNumInt.make_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.KNumInt.make_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Mask to indicate whether a shell is zero on grid.
The resultant mask array is an extension to the mask array used in
molecular code (see also pyscf.dft.numint.make_mask function).
For given shell ID and block ID, the value of the extended mask array
means the number of images in Ls that does not vanish.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.KNumInt.nr_rks">
<span class="sig-name descname"><span class="pre">nr_rks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#KNumInt.nr_rks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.KNumInt.nr_rks" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate RKS XC functional and potential matrix for given meshgrids and density matrix</p>
<p>Note: This is a replica of pyscf.dft.numint.nr_rks_vxc with kpts added.
This implemented uses slow function in numint, which only calls eval_rho, eval_mat.
Faster function uses eval_rho2 which is not yet implemented.</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.pbc.dft.numint.NumInt" title="pyscf.pbc.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a> or <a class="reference internal" href="#pyscf.pbc.dft.numint.KNumInt" title="pyscf.pbc.dft.numint.KNumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></a></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D/3D array or a list of 2D/3D arrays</span></dt><dd><p>Density matrices (2D) / density matrices for k-points (3D)</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>spin<span class="classifier">int</span></dt><dd><p>spin polarized if spin = 1</p>
</dd>
<dt>relativity<span class="classifier">int</span></dt><dd><p>No effects.</p>
</dd>
<dt>hermi<span class="classifier">int</span></dt><dd><p>No effects</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
<dt>kpts<span class="classifier">(3,) ndarray or (nkpts,3) ndarray</span></dt><dd><p>Single or multiple k-points sampled for the DM.  Default is gamma point.</p>
</dd>
<dt>kpts_band<span class="classifier">(3,) ndarray or (<a href="#id15"><span class="problematic" id="id16">*</span></a>,3) ndarray</span></dt><dd><p>A list of arbitrary “band” k-points at which to evaluate the XC matrix.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.KNumInt.nr_rks_fxc">
<span class="sig-name descname"><span class="pre">nr_rks_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint.KNumInt.nr_rks_fxc" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract RKS XC kernel matrix with given density matrices</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.pbc.dft.numint.NumInt" title="pyscf.pbc.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a> or <a class="reference internal" href="#pyscf.pbc.dft.numint.KNumInt" title="pyscf.pbc.dft.numint.KNumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></a></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D/3D array or a list of 2D/3D arrays</span></dt><dd><p>Density matrices (2D) / density matrices for k-points (3D)</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Input density matrices symmetric or not</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>rho0<span class="classifier">float array</span></dt><dd><p>Zero-order density (and density derivative for GGA).  Giving kwargs rho0,
vxc and fxc to improve better performance.</p>
</dd>
<dt>vxc<span class="classifier">float array</span></dt><dd><p>First order XC derivatives</p>
</dd>
<dt>fxc<span class="classifier">float array</span></dt><dd><p>Second order XC derivatives</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.KNumInt.nr_uks">
<span class="sig-name descname"><span class="pre">nr_uks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#KNumInt.nr_uks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.KNumInt.nr_uks" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate UKS XC functional and potential matrix for given meshgrids and density matrix</p>
<p>Note: This is a replica of pyscf.dft.numint.nr_rks_vxc with kpts added.
This implemented uses slow function in numint, which only calls eval_rho, eval_mat.
Faster function uses eval_rho2 which is not yet implemented.</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.pbc.dft.numint.NumInt" title="pyscf.pbc.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a> or <a class="reference internal" href="#pyscf.pbc.dft.numint.KNumInt" title="pyscf.pbc.dft.numint.KNumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></a></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms :</dt><dd><p>Density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>spin<span class="classifier">int</span></dt><dd><p>spin polarized if spin = 1</p>
</dd>
<dt>relativity<span class="classifier">int</span></dt><dd><p>No effects.</p>
</dd>
<dt>hermi<span class="classifier">int</span></dt><dd><p>Input density matrices symmetric or not</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
<dt>kpts<span class="classifier">(3,) ndarray or (nkpts,3) ndarray</span></dt><dd><p>Single or multiple k-points sampled for the DM.  Default is gamma point.
kpts_band : (3,) ndarray or (<a href="#id17"><span class="problematic" id="id18">*</span></a>,3) ndarray
A list of arbitrary “band” k-points at which to evaluate the XC matrix.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.KNumInt.nr_uks_fxc">
<span class="sig-name descname"><span class="pre">nr_uks_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint.KNumInt.nr_uks_fxc" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract UKS XC kernel matrix with given density matrices</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.pbc.dft.numint.NumInt" title="pyscf.pbc.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a> or <a class="reference internal" href="#pyscf.pbc.dft.numint.KNumInt" title="pyscf.pbc.dft.numint.KNumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></a></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D array a list of 2D arrays</span></dt><dd><p>Density matrix or multiple density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Input density matrices symmetric or not</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>rho0<span class="classifier">float array</span></dt><dd><p>Zero-order density (and density derivative for GGA).  Giving kwargs rho0,
vxc and fxc to improve better performance.</p>
</dd>
<dt>vxc<span class="classifier">float array</span></dt><dd><p>First order XC derivatives</p>
</dd>
<dt>fxc<span class="classifier">float array</span></dt><dd><p>Second order XC derivatives</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
<p>Examples:</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.KNumInt.nr_vxc">
<span class="sig-name descname"><span class="pre">nr_vxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#KNumInt.nr_vxc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.KNumInt.nr_vxc" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate RKS/UKS XC functional and potential matrix.
See <a class="reference internal" href="#pyscf.pbc.dft.numint.nr_rks" title="pyscf.pbc.dft.numint.nr_rks"><code class="xref py py-func docutils literal notranslate"><span class="pre">nr_rks()</span></code></a> and <a class="reference internal" href="#pyscf.pbc.dft.numint.nr_uks" title="pyscf.pbc.dft.numint.nr_uks"><code class="xref py py-func docutils literal notranslate"><span class="pre">nr_uks()</span></code></a> for more details.</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.numint.</span></span><span class="sig-name descname"><span class="pre">NumInt</span></span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#NumInt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="pyscf.dft.html#pyscf.dft.numint.NumInt" title="pyscf.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.dft.numint.NumInt</span></code></a></p>
<p>Generalization of pyscf’s NumInt class for a single k-point shift and
periodic images.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt.block_loop">
<span class="sig-name descname"><span class="pre">block_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.,</span> <span class="pre">0.,</span> <span class="pre">0.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blksize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#NumInt.block_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt.block_loop" title="Permalink to this definition">¶</a></dt>
<dd><p>Define this macro to loop over grids by blocks.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt.cache_xc_kernel">
<span class="sig-name descname"><span class="pre">cache_xc_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt.cache_xc_kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the 0th order density, Vxc and fxc.  They can be used in TDDFT,
DFT hessian module etc.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt.eval_ao">
<span class="sig-name descname"><span class="pre">eval_ao</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.,</span> <span class="pre">0.,</span> <span class="pre">0.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#NumInt.eval_ao"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt.eval_ao" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate AO function value on the given grids.</p>
<dl>
<dt>Args:</dt><dd><p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl class="simple">
<dt>coords<span class="classifier">2D array, shape (N,3)</span></dt><dd><p>The coordinates of the grids.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>deriv<span class="classifier">int</span></dt><dd><p>AO derivative order.  It affects the shape of the return array.
If deriv=0, the returned AO values are stored in a (N,nao) array.
Otherwise the AO values are stored in an array of shape (M,N,nao).
Here N is the number of grids, nao is the number of AO functions,
M is the size associated to the derivative deriv.</p>
</dd>
<dt>relativity<span class="classifier">bool</span></dt><dd><p>No effects.</p>
</dd>
<dt>shls_slice<span class="classifier">2-element list</span></dt><dd><p>(shl_start, shl_end).
If given, only part of AOs (shl_start &lt;= shell_id &lt; shl_end) are
evaluated.  By default, all shells defined in mol will be evaluated.</p>
</dd>
<dt>non0tab<span class="classifier">2D bool array</span></dt><dd><p>mask array to indicate whether the AO values are zero.  The mask
array can be obtained by calling <a class="reference internal" href="#pyscf.pbc.dft.numint.NumInt.make_mask" title="pyscf.pbc.dft.numint.NumInt.make_mask"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_mask()</span></code></a></p>
</dd>
<dt>out<span class="classifier">ndarray</span></dt><dd><p>If provided, results are written into this array.</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>2D array of shape (N,nao) for AO values if deriv = 0.
Or 3D array of shape (:,N,nao) for AO values and AO derivatives if deriv &gt; 0.
In the 3D array, the first (N,nao) elements are the AO values,
followed by (3,N,nao) for x,y,z compoents;
Then 2nd derivatives (6,N,nao) for xx, xy, xz, yy, yz, zz;
Then 3rd derivatives (10,N,nao) for xxx, xxy, xxz, xyy, xyz, xzz, yyy, yyz, yzz, zzz;
…</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'O 0 0 0; H 0 0 1; H 0 1 0'</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">'ccpvdz'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coords</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>  <span class="c1"># 100 random points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span> <span class="o">=</span> <span class="n">eval_ao</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">coords</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ao_value</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(100, 24)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span> <span class="o">=</span> <span class="n">eval_ao</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shls_slice</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ao_value</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(4, 100, 7)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao_value</span> <span class="o">=</span> <span class="n">eval_ao</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">shls_slice</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ao_value</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(10, 100, 7)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt.eval_mat">
<span class="sig-name descname"><span class="pre">eval_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#NumInt.eval_mat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt.eval_mat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt.eval_rho">
<span class="sig-name descname"><span class="pre">eval_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#NumInt.eval_rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt.eval_rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Collocate the <em>real</em> density (opt. gradients) on the real-space grid.</p>
<dl>
<dt>Args:</dt><dd><p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl class="simple">
<dt>ao<span class="classifier">([4,] nx*ny*nz, nao=cell.nao_nr()) ndarray</span></dt><dd><p>The value of the AO crystal orbitals on the real-space grid by default.
If xctype=’GGA’, also contains the value of the gradient in the x, y,
and z directions.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>rho<span class="classifier">([4,] nx*ny*nz) ndarray</span></dt><dd><p>The value of the density on the real-space grid. If xctype=’GGA’,
also contains the value of the gradient in the x, y, and z
directions.</p>
</dd>
</dl>
</dd>
<dt>See Also:</dt><dd><p>pyscf.dft.numint.eval_rho</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt.eval_rho2">
<span class="sig-name descname"><span class="pre">eval_rho2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#NumInt.eval_rho2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt.eval_rho2" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the electron density for LDA functional, and the density
derivatives for GGA functional.  This function has the same functionality
as <a class="reference internal" href="#pyscf.pbc.dft.numint.eval_rho" title="pyscf.pbc.dft.numint.eval_rho"><code class="xref py py-func docutils literal notranslate"><span class="pre">eval_rho()</span></code></a> except that the density are evaluated based on orbital
coefficients and orbital occupancy.  It is more efficient than
<a class="reference internal" href="#pyscf.pbc.dft.numint.eval_rho" title="pyscf.pbc.dft.numint.eval_rho"><code class="xref py py-func docutils literal notranslate"><span class="pre">eval_rho()</span></code></a> in most scenario.</p>
<dl>
<dt>Args:</dt><dd><p>mol : an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code></p>
<dl class="simple">
<dt>ao<span class="classifier">2D array of shape (N,nao) for LDA, 3D array of shape (4,N,nao) for GGA</span></dt><dd><p>or (5,N,nao) for meta-GGA.  N is the number of grids, nao is the
number of AO functions.  If xctype is GGA, ao[0] is AO value
and ao[1:3] are the AO gradients.  If xctype is meta-GGA, ao[4:10]
are second derivatives of ao values.</p>
</dd>
<dt>dm<span class="classifier">2D array</span></dt><dd><p>Density matrix</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>non0tab<span class="classifier">2D bool array</span></dt><dd><p>mask array to indicate whether the AO values are zero.  The mask
array can be obtained by calling <a class="reference internal" href="#pyscf.pbc.dft.numint.NumInt.make_mask" title="pyscf.pbc.dft.numint.NumInt.make_mask"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_mask()</span></code></a></p>
</dd>
<dt>xctype<span class="classifier">str</span></dt><dd><p>LDA/GGA/mGGA.  It affects the shape of the return density.</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>1D array of size N to store electron density if xctype = LDA;  2D array
of (4,N) to store density and “density derivatives” for x,y,z components
if xctype = GGA;  (6,N) array for meta-GGA, where last two rows are
nabla^2 rho and tau = 1/2(nabla f)^2</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt.get_rho">
<span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.]])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt.get_rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Density in real space</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt.make_mask">
<span class="sig-name descname"><span class="pre">make_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#NumInt.make_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt.make_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Mask to indicate whether a shell is zero on grid.
The resultant mask array is an extension to the mask array used in
molecular code (see also pyscf.dft.numint.make_mask function).
For given shell ID and block ID, the value of the extended mask array
means the number of images in Ls that does not vanish.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt.nr_rks">
<span class="sig-name descname"><span class="pre">nr_rks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.,</span> <span class="pre">0.,</span> <span class="pre">0.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#NumInt.nr_rks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt.nr_rks" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate RKS XC functional and potential matrix for given meshgrids and density matrix</p>
<p>Note: This is a replica of pyscf.dft.numint.nr_rks_vxc with kpts added.
This implemented uses slow function in numint, which only calls eval_rho, eval_mat.
Faster function uses eval_rho2 which is not yet implemented.</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.pbc.dft.numint.NumInt" title="pyscf.pbc.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a> or <a class="reference internal" href="#pyscf.pbc.dft.numint.KNumInt" title="pyscf.pbc.dft.numint.KNumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></a></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D/3D array or a list of 2D/3D arrays</span></dt><dd><p>Density matrices (2D) / density matrices for k-points (3D)</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>spin<span class="classifier">int</span></dt><dd><p>spin polarized if spin = 1</p>
</dd>
<dt>relativity<span class="classifier">int</span></dt><dd><p>No effects.</p>
</dd>
<dt>hermi<span class="classifier">int</span></dt><dd><p>No effects</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
<dt>kpts<span class="classifier">(3,) ndarray or (nkpts,3) ndarray</span></dt><dd><p>Single or multiple k-points sampled for the DM.  Default is gamma point.</p>
</dd>
<dt>kpts_band<span class="classifier">(3,) ndarray or (<a href="#id19"><span class="problematic" id="id20">*</span></a>,3) ndarray</span></dt><dd><p>A list of arbitrary “band” k-points at which to evaluate the XC matrix.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt.nr_rks_fxc">
<span class="sig-name descname"><span class="pre">nr_rks_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt.nr_rks_fxc" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract RKS XC kernel matrix with given density matrices</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.pbc.dft.numint.NumInt" title="pyscf.pbc.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a> or <a class="reference internal" href="#pyscf.pbc.dft.numint.KNumInt" title="pyscf.pbc.dft.numint.KNumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></a></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D/3D array or a list of 2D/3D arrays</span></dt><dd><p>Density matrices (2D) / density matrices for k-points (3D)</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Input density matrices symmetric or not</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>rho0<span class="classifier">float array</span></dt><dd><p>Zero-order density (and density derivative for GGA).  Giving kwargs rho0,
vxc and fxc to improve better performance.</p>
</dd>
<dt>vxc<span class="classifier">float array</span></dt><dd><p>First order XC derivatives</p>
</dd>
<dt>fxc<span class="classifier">float array</span></dt><dd><p>Second order XC derivatives</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt.nr_uks">
<span class="sig-name descname"><span class="pre">nr_uks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.,</span> <span class="pre">0.,</span> <span class="pre">0.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#NumInt.nr_uks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt.nr_uks" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate UKS XC functional and potential matrix for given meshgrids and density matrix</p>
<p>Note: This is a replica of pyscf.dft.numint.nr_rks_vxc with kpts added.
This implemented uses slow function in numint, which only calls eval_rho, eval_mat.
Faster function uses eval_rho2 which is not yet implemented.</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.pbc.dft.numint.NumInt" title="pyscf.pbc.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a> or <a class="reference internal" href="#pyscf.pbc.dft.numint.KNumInt" title="pyscf.pbc.dft.numint.KNumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></a></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms :</dt><dd><p>Density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>spin<span class="classifier">int</span></dt><dd><p>spin polarized if spin = 1</p>
</dd>
<dt>relativity<span class="classifier">int</span></dt><dd><p>No effects.</p>
</dd>
<dt>hermi<span class="classifier">int</span></dt><dd><p>Input density matrices symmetric or not</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
<dt>kpts<span class="classifier">(3,) ndarray or (nkpts,3) ndarray</span></dt><dd><p>Single or multiple k-points sampled for the DM.  Default is gamma point.
kpts_band : (3,) ndarray or (<a href="#id21"><span class="problematic" id="id22">*</span></a>,3) ndarray
A list of arbitrary “band” k-points at which to evaluate the XC matrix.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt.nr_uks_fxc">
<span class="sig-name descname"><span class="pre">nr_uks_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt.nr_uks_fxc" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract UKS XC kernel matrix with given density matrices</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.pbc.dft.numint.NumInt" title="pyscf.pbc.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a> or <a class="reference internal" href="#pyscf.pbc.dft.numint.KNumInt" title="pyscf.pbc.dft.numint.KNumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></a></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D array a list of 2D arrays</span></dt><dd><p>Density matrix or multiple density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Input density matrices symmetric or not</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>rho0<span class="classifier">float array</span></dt><dd><p>Zero-order density (and density derivative for GGA).  Giving kwargs rho0,
vxc and fxc to improve better performance.</p>
</dd>
<dt>vxc<span class="classifier">float array</span></dt><dd><p>First order XC derivatives</p>
</dd>
<dt>fxc<span class="classifier">float array</span></dt><dd><p>Second order XC derivatives</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
<p>Examples:</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.NumInt.nr_vxc">
<span class="sig-name descname"><span class="pre">nr_vxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#NumInt.nr_vxc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.NumInt.nr_vxc" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate RKS/UKS XC functional and potential matrix.
See <a class="reference internal" href="#pyscf.pbc.dft.numint.nr_rks" title="pyscf.pbc.dft.numint.nr_rks"><code class="xref py py-func docutils literal notranslate"><span class="pre">nr_rks()</span></code></a> and <a class="reference internal" href="#pyscf.pbc.dft.numint.nr_uks" title="pyscf.pbc.dft.numint.nr_uks"><code class="xref py py-func docutils literal notranslate"><span class="pre">nr_uks()</span></code></a> for more details.</p>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.cache_xc_kernel">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.numint.</span></span><span class="sig-name descname"><span class="pre">cache_xc_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#cache_xc_kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.cache_xc_kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the 0th order density, Vxc and fxc.  They can be used in TDDFT,
DFT hessian module etc.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.eval_ao">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.numint.</span></span><span class="sig-name descname"><span class="pre">eval_ao</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.,</span> <span class="pre">0.,</span> <span class="pre">0.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#eval_ao"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.eval_ao" title="Permalink to this definition">¶</a></dt>
<dd><p>Collocate AO crystal orbitals (opt. gradients) on the real-space grid.</p>
<dl>
<dt>Args:</dt><dd><p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl class="simple">
<dt>coords<span class="classifier">(nx*ny*nz, 3) ndarray</span></dt><dd><p>The real-space grid point coordinates.</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>kpt<span class="classifier">(3,) ndarray</span></dt><dd><p>The k-point corresponding to the crystal AO.</p>
</dd>
<dt>deriv<span class="classifier">int</span></dt><dd><p>AO derivative order.  It affects the shape of the return array.
If deriv=0, the returned AO values are stored in a (N,nao) array.
Otherwise the AO values are stored in an array of shape (M,N,nao).
Here N is the number of grids, nao is the number of AO functions,
M is the size associated to the derivative deriv.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>aoR<span class="classifier">([4,] nx*ny*nz, nao=cell.nao_nr()) ndarray</span></dt><dd><p>The value of the AO crystal orbitals on the real-space grid by default.
If deriv=1, also contains the value of the orbitals gradient in the
x, y, and z directions.  It can be either complex or float array,
depending on the kpt argument.  If kpt is not given (gamma point),
aoR is a float array.</p>
</dd>
</dl>
</dd>
<dt>See Also:</dt><dd><p>pyscf.dft.numint.eval_ao</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.eval_ao_kpts">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.numint.</span></span><span class="sig-name descname"><span class="pre">eval_ao_kpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shls_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#eval_ao_kpts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.eval_ao_kpts" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Returns:</dt><dd><dl class="simple">
<dt>ao_kpts: (nkpts, [comp], ngrids, nao) ndarray</dt><dd><p>AO values at each k-point</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.eval_rho">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.numint.</span></span><span class="sig-name descname"><span class="pre">eval_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#eval_rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.eval_rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Collocate the <em>real</em> density (opt. gradients) on the real-space grid.</p>
<dl>
<dt>Args:</dt><dd><p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl class="simple">
<dt>ao<span class="classifier">([4,] nx*ny*nz, nao=cell.nao_nr()) ndarray</span></dt><dd><p>The value of the AO crystal orbitals on the real-space grid by default.
If xctype=’GGA’, also contains the value of the gradient in the x, y,
and z directions.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>rho<span class="classifier">([4,] nx*ny*nz) ndarray</span></dt><dd><p>The value of the density on the real-space grid. If xctype=’GGA’,
also contains the value of the gradient in the x, y, and z
directions.</p>
</dd>
</dl>
</dd>
<dt>See Also:</dt><dd><p>pyscf.dft.numint.eval_rho</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.eval_rho2">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.numint.</span></span><span class="sig-name descname"><span class="pre">eval_rho2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non0tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#eval_rho2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.eval_rho2" title="Permalink to this definition">¶</a></dt>
<dd><p>Refer to <cite>pyscf.dft.numint.eval_rho2</cite> for full documentation.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.get_rho">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.numint.</span></span><span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.]])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#get_rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.get_rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Density in real space</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.nr_rks">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.numint.</span></span><span class="sig-name descname"><span class="pre">nr_rks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#nr_rks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.nr_rks" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate RKS XC functional and potential matrix for given meshgrids and density matrix</p>
<p>Note: This is a replica of pyscf.dft.numint.nr_rks_vxc with kpts added.
This implemented uses slow function in numint, which only calls eval_rho, eval_mat.
Faster function uses eval_rho2 which is not yet implemented.</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.pbc.dft.numint.NumInt" title="pyscf.pbc.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a> or <a class="reference internal" href="#pyscf.pbc.dft.numint.KNumInt" title="pyscf.pbc.dft.numint.KNumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></a></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D/3D array or a list of 2D/3D arrays</span></dt><dd><p>Density matrices (2D) / density matrices for k-points (3D)</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>spin<span class="classifier">int</span></dt><dd><p>spin polarized if spin = 1</p>
</dd>
<dt>relativity<span class="classifier">int</span></dt><dd><p>No effects.</p>
</dd>
<dt>hermi<span class="classifier">int</span></dt><dd><p>No effects</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
<dt>kpts<span class="classifier">(3,) ndarray or (nkpts,3) ndarray</span></dt><dd><p>Single or multiple k-points sampled for the DM.  Default is gamma point.</p>
</dd>
<dt>kpts_band<span class="classifier">(3,) ndarray or (<a href="#id23"><span class="problematic" id="id24">*</span></a>,3) ndarray</span></dt><dd><p>A list of arbitrary “band” k-points at which to evaluate the XC matrix.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.nr_rks_fxc">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.numint.</span></span><span class="sig-name descname"><span class="pre">nr_rks_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#nr_rks_fxc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.nr_rks_fxc" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract RKS XC kernel matrix with given density matrices</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.pbc.dft.numint.NumInt" title="pyscf.pbc.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a> or <a class="reference internal" href="#pyscf.pbc.dft.numint.KNumInt" title="pyscf.pbc.dft.numint.KNumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></a></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D/3D array or a list of 2D/3D arrays</span></dt><dd><p>Density matrices (2D) / density matrices for k-points (3D)</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Input density matrices symmetric or not</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>rho0<span class="classifier">float array</span></dt><dd><p>Zero-order density (and density derivative for GGA).  Giving kwargs rho0,
vxc and fxc to improve better performance.</p>
</dd>
<dt>vxc<span class="classifier">float array</span></dt><dd><p>First order XC derivatives</p>
</dd>
<dt>fxc<span class="classifier">float array</span></dt><dd><p>Second order XC derivatives</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.nr_rks_fxc_st">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.numint.</span></span><span class="sig-name descname"><span class="pre">nr_rks_fxc_st</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms_alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">singlet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#nr_rks_fxc_st"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.nr_rks_fxc_st" title="Permalink to this definition">¶</a></dt>
<dd><p>Associated to singlet or triplet Hessian
Note the difference to nr_rks_fxc, dms_alpha is the response density
matrices of alpha spin, alpha+/-beta DM is applied due to singlet/triplet
coupling</p>
<p>Ref. CPL, 256, 454</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.nr_rks_vxc">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.numint.</span></span><span class="sig-name descname"><span class="pre">nr_rks_vxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint.nr_rks_vxc" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate RKS XC functional and potential matrix for given meshgrids and density matrix</p>
<p>Note: This is a replica of pyscf.dft.numint.nr_rks_vxc with kpts added.
This implemented uses slow function in numint, which only calls eval_rho, eval_mat.
Faster function uses eval_rho2 which is not yet implemented.</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.pbc.dft.numint.NumInt" title="pyscf.pbc.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a> or <a class="reference internal" href="#pyscf.pbc.dft.numint.KNumInt" title="pyscf.pbc.dft.numint.KNumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></a></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D/3D array or a list of 2D/3D arrays</span></dt><dd><p>Density matrices (2D) / density matrices for k-points (3D)</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>spin<span class="classifier">int</span></dt><dd><p>spin polarized if spin = 1</p>
</dd>
<dt>relativity<span class="classifier">int</span></dt><dd><p>No effects.</p>
</dd>
<dt>hermi<span class="classifier">int</span></dt><dd><p>No effects</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
<dt>kpts<span class="classifier">(3,) ndarray or (nkpts,3) ndarray</span></dt><dd><p>Single or multiple k-points sampled for the DM.  Default is gamma point.</p>
</dd>
<dt>kpts_band<span class="classifier">(3,) ndarray or (<a href="#id25"><span class="problematic" id="id26">*</span></a>,3) ndarray</span></dt><dd><p>A list of arbitrary “band” k-points at which to evaluate the XC matrix.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.nr_uks">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.numint.</span></span><span class="sig-name descname"><span class="pre">nr_uks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#nr_uks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.nr_uks" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate UKS XC functional and potential matrix for given meshgrids and density matrix</p>
<p>Note: This is a replica of pyscf.dft.numint.nr_rks_vxc with kpts added.
This implemented uses slow function in numint, which only calls eval_rho, eval_mat.
Faster function uses eval_rho2 which is not yet implemented.</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.pbc.dft.numint.NumInt" title="pyscf.pbc.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a> or <a class="reference internal" href="#pyscf.pbc.dft.numint.KNumInt" title="pyscf.pbc.dft.numint.KNumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></a></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms :</dt><dd><p>Density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>spin<span class="classifier">int</span></dt><dd><p>spin polarized if spin = 1</p>
</dd>
<dt>relativity<span class="classifier">int</span></dt><dd><p>No effects.</p>
</dd>
<dt>hermi<span class="classifier">int</span></dt><dd><p>Input density matrices symmetric or not</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
<dt>kpts<span class="classifier">(3,) ndarray or (nkpts,3) ndarray</span></dt><dd><p>Single or multiple k-points sampled for the DM.  Default is gamma point.
kpts_band : (3,) ndarray or (<a href="#id27"><span class="problematic" id="id28">*</span></a>,3) ndarray
A list of arbitrary “band” k-points at which to evaluate the XC matrix.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.nr_uks_fxc">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.numint.</span></span><span class="sig-name descname"><span class="pre">nr_uks_fxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fxc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/numint.html#nr_uks_fxc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.numint.nr_uks_fxc" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract UKS XC kernel matrix with given density matrices</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.pbc.dft.numint.NumInt" title="pyscf.pbc.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a> or <a class="reference internal" href="#pyscf.pbc.dft.numint.KNumInt" title="pyscf.pbc.dft.numint.KNumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></a></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms<span class="classifier">2D array a list of 2D arrays</span></dt><dd><p>Density matrix or multiple density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>hermi<span class="classifier">int</span></dt><dd><p>Input density matrices symmetric or not</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>rho0<span class="classifier">float array</span></dt><dd><p>Zero-order density (and density derivative for GGA).  Giving kwargs rho0,
vxc and fxc to improve better performance.</p>
</dd>
<dt>vxc<span class="classifier">float array</span></dt><dd><p>First order XC derivatives</p>
</dd>
<dt>fxc<span class="classifier">float array</span></dt><dd><p>Second order XC derivatives</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
<p>Examples:</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.numint.nr_uks_vxc">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.numint.</span></span><span class="sig-name descname"><span class="pre">nr_uks_vxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.numint.nr_uks_vxc" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate UKS XC functional and potential matrix for given meshgrids and density matrix</p>
<p>Note: This is a replica of pyscf.dft.numint.nr_rks_vxc with kpts added.
This implemented uses slow function in numint, which only calls eval_rho, eval_mat.
Faster function uses eval_rho2 which is not yet implemented.</p>
<dl>
<dt>Args:</dt><dd><p>ni : an instance of <a class="reference internal" href="#pyscf.pbc.dft.numint.NumInt" title="pyscf.pbc.dft.numint.NumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumInt</span></code></a> or <a class="reference internal" href="#pyscf.pbc.dft.numint.KNumInt" title="pyscf.pbc.dft.numint.KNumInt"><code class="xref py py-class docutils literal notranslate"><span class="pre">KNumInt</span></code></a></p>
<p>cell : instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Mole</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Cell</span></code></p>
<dl>
<dt>grids<span class="classifier">an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Grids</span></code></span></dt><dd><p>grids.coords and grids.weights are needed for coordinates and weights of meshgrids.</p>
</dd>
<dt>xc_code<span class="classifier">str</span></dt><dd><p>XC functional description.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_xc()</span></code> of pyscf/dft/libxc.py for more details.</p>
</dd>
<dt>dms :</dt><dd><p>Density matrices</p>
</dd>
</dl>
</dd>
<dt>Kwargs:</dt><dd><dl>
<dt>spin<span class="classifier">int</span></dt><dd><p>spin polarized if spin = 1</p>
</dd>
<dt>relativity<span class="classifier">int</span></dt><dd><p>No effects.</p>
</dd>
<dt>hermi<span class="classifier">int</span></dt><dd><p>Input density matrices symmetric or not</p>
</dd>
<dt>max_memory<span class="classifier">int or float</span></dt><dd><p>The maximum size of cache to use (in MB).</p>
</dd>
<dt>verbose<span class="classifier">int or object of <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></span></dt><dd><p>No effects.</p>
</dd>
<dt>kpts<span class="classifier">(3,) ndarray or (nkpts,3) ndarray</span></dt><dd><p>Single or multiple k-points sampled for the DM.  Default is gamma point.
kpts_band : (3,) ndarray or (<a href="#id29"><span class="problematic" id="id30">*</span></a>,3) ndarray
A list of arbitrary “band” k-points at which to evaluate the XC matrix.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>nelec, excsum, vmat.
nelec is the number of electrons generated by numerical integration.
excsum is the XC functional value.  vmat is the XC potential matrix in
2D array of shape (nao,nao) where nao is the number of AO functions.</p>
</dd>
</dl>
</dd></dl>
</section>
<section id="module-pyscf.pbc.dft.rks">
<span id="pyscf-pbc-dft-rks-module"></span><h2 id="module-pyscf.pbc.dft.rks">pyscf.pbc.dft.rks module<a class="headerlink" href="#module-pyscf.pbc.dft.rks" title="Permalink to this headline">¶</a></h2>
<p>Non-relativistic Restricted Kohn-Sham for periodic systems at a single k-point</p>
<dl class="simple">
<dt>See Also:</dt><dd><dl class="simple">
<dt>pyscf.pbc.dft.krks.py<span class="classifier">Non-relativistic Restricted Kohn-Sham for periodic</span></dt><dd><p>systems with k-point sampling</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.KohnShamDFT">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.rks.</span></span><span class="sig-name descname"><span class="pre">KohnShamDFT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/rks.html#KohnShamDFT"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.rks.KohnShamDFT" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="pyscf.dft.html#pyscf.dft.rks.KohnShamDFT" title="pyscf.dft.rks.KohnShamDFT"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.dft.rks.KohnShamDFT</span></code></a></p>
<p>PBC-KS</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.KohnShamDFT.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/rks.html#KohnShamDFT.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.rks.KohnShamDFT.dump_flags" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.KohnShamDFT.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/rks.html#KohnShamDFT.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.rks.KohnShamDFT.reset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.RKS">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.rks.</span></span><span class="sig-name descname"><span class="pre">RKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.,</span> <span class="pre">0.,</span> <span class="pre">0.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ewald'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/rks.html#RKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.rks.RKS" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.pbc.dft.rks.KohnShamDFT" title="pyscf.pbc.dft.rks.KohnShamDFT"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.pbc.dft.rks.KohnShamDFT</span></code></a>, <a class="reference internal" href="pyscf.pbc.scf.html#pyscf.pbc.scf.hf.RHF" title="pyscf.pbc.scf.hf.RHF"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.pbc.scf.hf.RHF</span></code></a></p>
<p>RKS class adapted for PBCs.</p>
<p>This is a literal duplication of the molecular RKS class with some <cite>mol</cite>
variables replaced by <cite>cell</cite>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.RKS.density_fit">
<span class="sig-name descname"><span class="pre">density_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">auxbasis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.rks.RKS.density_fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.RKS.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/rks.html#RKS.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.rks.RKS.dump_flags" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.RKS.energy_elec">
<span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.rks.RKS.energy_elec" title="Permalink to this definition">¶</a></dt>
<dd><p>Electronic part of RKS energy.</p>
<p>Note this function has side effects which cause mf.scf_summary updated.</p>
<dl>
<dt>Args:</dt><dd><p>ks : an instance of DFT class</p>
<dl class="simple">
<dt>dm<span class="classifier">2D ndarray</span></dt><dd><p>one-partical density matrix</p>
</dd>
<dt>h1e<span class="classifier">2D ndarray</span></dt><dd><p>Core hamiltonian</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>RKS electronic energy and the 2-electron contribution</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.RKS.get_rho">
<span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.rks.RKS.get_rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute density in real space</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.RKS.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.rks.RKS.get_veff" title="Permalink to this definition">¶</a></dt>
<dd><p>Coulomb + XC functional</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function will change the ks object.</p>
</div>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <a class="reference internal" href="#pyscf.pbc.dft.rks.RKS" title="pyscf.pbc.dft.rks.RKS"><code class="xref py py-class docutils literal notranslate"><span class="pre">RKS</span></code></a></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
<dt>dm<span class="classifier">ndarray or list of ndarrays</span></dt><dd><p>A density matrix or a list of density matrices</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>matrix Veff = J + Vxc.  Veff can be a list matrices, if the input
dm is a list of density matrices.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.RKS.mix_density_fit">
<span class="sig-name descname"><span class="pre">mix_density_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">auxbasis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.rks.RKS.mix_density_fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.get_rho">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.rks.</span></span><span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/rks.html#get_rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.rks.get_rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute density in real space</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.get_veff">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.rks.</span></span><span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/rks.html#get_veff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.rks.get_veff" title="Permalink to this definition">¶</a></dt>
<dd><p>Coulomb + XC functional</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function will change the ks object.</p>
</div>
<dl>
<dt>Args:</dt><dd><dl>
<dt>ks<span class="classifier">an instance of <a class="reference internal" href="#pyscf.pbc.dft.rks.RKS" title="pyscf.pbc.dft.rks.RKS"><code class="xref py py-class docutils literal notranslate"><span class="pre">RKS</span></code></a></span></dt><dd><p>XC functional are controlled by ks.xc attribute.  Attribute
ks.grids might be initialized.</p>
</dd>
<dt>dm<span class="classifier">ndarray or list of ndarrays</span></dt><dd><p>A density matrix or a list of density matrices</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>matrix Veff = J + Vxc.  Veff can be a list matrices, if the input
dm is a list of density matrices.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.rks.prune_small_rho_grids_">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.rks.</span></span><span class="sig-name descname"><span class="pre">prune_small_rho_grids_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/rks.html#prune_small_rho_grids_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.rks.prune_small_rho_grids_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
</section>
<section id="module-pyscf.pbc.dft.roks">
<span id="pyscf-pbc-dft-roks-module"></span><h2 id="module-pyscf.pbc.dft.roks">pyscf.pbc.dft.roks module<a class="headerlink" href="#module-pyscf.pbc.dft.roks" title="Permalink to this headline">¶</a></h2>
<p>Restricted open-shell Kohn-Sham for periodic systems at a single k-point</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.dft.roks.ROKS">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.roks.</span></span><span class="sig-name descname"><span class="pre">ROKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.,</span> <span class="pre">0.,</span> <span class="pre">0.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ewald'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/roks.html#ROKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.roks.ROKS" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.pbc.dft.rks.KohnShamDFT" title="pyscf.pbc.dft.rks.KohnShamDFT"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.pbc.dft.rks.KohnShamDFT</span></code></a>, <a class="reference internal" href="pyscf.pbc.scf.html#pyscf.pbc.scf.rohf.ROHF" title="pyscf.pbc.scf.rohf.ROHF"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.pbc.scf.rohf.ROHF</span></code></a></p>
<p>UKS class adapted for PBCs.</p>
<p>This is a literal duplication of the molecular UKS class with some <cite>mol</cite>
variables replaced by <cite>cell</cite>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.roks.ROKS.density_fit">
<span class="sig-name descname"><span class="pre">density_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">auxbasis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.roks.ROKS.density_fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.roks.ROKS.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/roks.html#ROKS.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.roks.ROKS.dump_flags" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.roks.ROKS.energy_elec">
<span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.roks.ROKS.energy_elec" title="Permalink to this definition">¶</a></dt>
<dd><p>Electronic part of Hartree-Fock energy, for given core hamiltonian and
HF potential</p>
<p>… math:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">E</span> <span class="o">=</span> \<span class="n">sum_</span><span class="p">{</span><span class="n">ij</span><span class="p">}</span><span class="n">h_</span><span class="p">{</span><span class="n">ij</span><span class="p">}</span> \<span class="n">gamma_</span><span class="p">{</span><span class="n">ji</span><span class="p">}</span>
  <span class="o">+</span> \<span class="n">frac</span><span class="p">{</span><span class="mi">1</span><span class="p">}{</span><span class="mi">2</span><span class="p">}</span>\<span class="n">sum_</span><span class="p">{</span><span class="n">ijkl</span><span class="p">}</span> \<span class="n">gamma_</span><span class="p">{</span><span class="n">ji</span><span class="p">}</span>\<span class="n">gamma_</span><span class="p">{</span><span class="n">lk</span><span class="p">}</span> \<span class="n">langle</span> <span class="n">ik</span><span class="o">||</span><span class="n">jl</span>\<span class="n">rangle</span>
</pre></div>
</div>
<p>Note this function has side effects which cause mf.scf_summary updated.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>mf : an instance of SCF class</p>
</dd>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>dm<span class="classifier">2D ndarray</span></dt><dd><p>one-partical density matrix</p>
</dd>
<dt>h1e<span class="classifier">2D ndarray</span></dt><dd><p>Core hamiltonian</p>
</dd>
<dt>vhf<span class="classifier">2D ndarray</span></dt><dd><p>HF potential</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>Hartree-Fock electronic energy and the Coulomb energy</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">'H 0 0 0; H 0 0 1.1'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">make_rdm1</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scf</span><span class="o">.</span><span class="n">hf</span><span class="o">.</span><span class="n">energy_elec</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="n">dm</span><span class="p">)</span>
<span class="go">(-1.5176090667746334, 0.60917167853723675)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">energy_elec</span><span class="p">(</span><span class="n">dm</span><span class="p">)</span>
<span class="go">(-1.5176090667746334, 0.60917167853723675)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.roks.ROKS.get_rho">
<span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.roks.ROKS.get_rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute density in real space</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.roks.ROKS.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.roks.ROKS.get_veff" title="Permalink to this definition">¶</a></dt>
<dd><p>Coulomb + XC functional for UKS.  See pyscf/pbc/dft/uks.py
<a class="reference internal" href="#pyscf.pbc.dft.roks.get_veff" title="pyscf.pbc.dft.roks.get_veff"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_veff()</span></code></a> fore more details.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.roks.ROKS.mix_density_fit">
<span class="sig-name descname"><span class="pre">mix_density_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">auxbasis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.roks.ROKS.mix_density_fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.roks.get_veff">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.roks.</span></span><span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/roks.html#get_veff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.roks.get_veff" title="Permalink to this definition">¶</a></dt>
<dd><p>Coulomb + XC functional for UKS.  See pyscf/pbc/dft/uks.py
<a class="reference internal" href="#pyscf.pbc.dft.roks.get_veff" title="pyscf.pbc.dft.roks.get_veff"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_veff()</span></code></a> fore more details.</p>
</dd></dl>
</section>
<section id="module-pyscf.pbc.dft.uks">
<span id="pyscf-pbc-dft-uks-module"></span><h2 id="module-pyscf.pbc.dft.uks">pyscf.pbc.dft.uks module<a class="headerlink" href="#module-pyscf.pbc.dft.uks" title="Permalink to this headline">¶</a></h2>
<p>Non-relativistic Restricted Kohn-Sham for periodic systems at a single k-point</p>
<dl class="simple">
<dt>See Also:</dt><dd><dl class="simple">
<dt>pyscf.pbc.dft.krks.py<span class="classifier">Non-relativistic Restricted Kohn-Sham for periodic</span></dt><dd><p>systems with k-point sampling</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="pyscf.pbc.dft.uks.UKS">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.uks.</span></span><span class="sig-name descname"><span class="pre">UKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.,</span> <span class="pre">0.,</span> <span class="pre">0.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LDA,VWN'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exxdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ewald'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/uks.html#UKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.uks.UKS" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyscf.pbc.dft.rks.KohnShamDFT" title="pyscf.pbc.dft.rks.KohnShamDFT"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.pbc.dft.rks.KohnShamDFT</span></code></a>, <a class="reference internal" href="pyscf.pbc.scf.html#pyscf.pbc.scf.uhf.UHF" title="pyscf.pbc.scf.uhf.UHF"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.pbc.scf.uhf.UHF</span></code></a></p>
<p>UKS class adapted for PBCs.</p>
<p>This is a literal duplication of the molecular UKS class with some <cite>mol</cite>
variables replaced by <cite>cell</cite>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.uks.UKS.density_fit">
<span class="sig-name descname"><span class="pre">density_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">auxbasis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.uks.UKS.density_fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.uks.UKS.dump_flags">
<span class="sig-name descname"><span class="pre">dump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/uks.html#UKS.dump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.uks.UKS.dump_flags" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.uks.UKS.energy_elec">
<span class="sig-name descname"><span class="pre">energy_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.uks.UKS.energy_elec" title="Permalink to this definition">¶</a></dt>
<dd><p>Electronic energy of Unrestricted Hartree-Fock</p>
<p>Note this function has side effects which cause mf.scf_summary updated.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>Hartree-Fock electronic energy and the 2-electron part contribution</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.uks.UKS.get_rho">
<span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.uks.UKS.get_rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute density in real space</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.uks.UKS.get_veff">
<span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.uks.UKS.get_veff" title="Permalink to this definition">¶</a></dt>
<dd><p>Coulomb + XC functional for UKS.  See pyscf/pbc/dft/uks.py
<a class="reference internal" href="#pyscf.pbc.dft.uks.get_veff" title="pyscf.pbc.dft.uks.get_veff"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_veff()</span></code></a> fore more details.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyscf.pbc.dft.uks.UKS.mix_density_fit">
<span class="sig-name descname"><span class="pre">mix_density_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">auxbasis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.pbc.dft.uks.UKS.mix_density_fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.uks.get_rho">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.uks.</span></span><span class="sig-name descname"><span class="pre">get_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/uks.html#get_rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.uks.get_rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute density in real space</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.uks.get_veff">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.uks.</span></span><span class="sig-name descname"><span class="pre">get_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vhf_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft/uks.html#get_veff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.uks.get_veff" title="Permalink to this definition">¶</a></dt>
<dd><p>Coulomb + XC functional for UKS.  See pyscf/pbc/dft/uks.py
<a class="reference internal" href="#pyscf.pbc.dft.uks.get_veff" title="pyscf.pbc.dft.uks.get_veff"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_veff()</span></code></a> fore more details.</p>
</dd></dl>
</section>
<section id="module-pyscf.pbc.dft">
<span id="module-contents"></span><h2 id="module-pyscf.pbc.dft">Module contents<a class="headerlink" href="#module-pyscf.pbc.dft" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.KKS">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.</span></span><span class="sig-name descname"><span class="pre">KKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft.html#KKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.KKS" title="Permalink to this definition">¶</a></dt>
<dd><p>A wrap function to create DFT object with k-point sampling (KRKS or KUKS).</p>
<p>RKS class adapted for PBCs with k-point sampling.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.KS">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.</span></span><span class="sig-name descname"><span class="pre">KS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft.html#KS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.KS" title="Permalink to this definition">¶</a></dt>
<dd><p>A wrap function to create DFT object (RKS or UKS) for PBC systems.</p>
<p>RKS class adapted for PBCs.</p>
<blockquote>
<div><p>This is a literal duplication of the molecular RKS class with some <cite>mol</cite>
variables replaced by <cite>cell</cite>.</p>
</div></blockquote>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyscf.pbc.dft.RKS">
<span class="sig-prename descclassname"><span class="pre">pyscf.pbc.dft.</span></span><span class="sig-name descname"><span class="pre">RKS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyscf/pbc/dft.html#RKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscf.pbc.dft.RKS" title="Permalink to this definition">¶</a></dt>
<dd><p>RKS class adapted for PBCs.</p>
<p>This is a literal duplication of the molecular RKS class with some <cite>mol</cite>
variables replaced by <cite>cell</cite>.</p>
</dd></dl>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="pyscf.pbc.df.html" title="pyscf.pbc.df package"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> pyscf.pbc.df package </span>
              </div>
            </a>
          
          
            <a href="pyscf.pbc.eph.html" title="pyscf.pbc.eph package"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> pyscf.pbc.eph package </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2015-2021, The PySCF Developers.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 4.0.1.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>